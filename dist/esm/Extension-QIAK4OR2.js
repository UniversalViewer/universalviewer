import{a as fe}from"./chunk-FTVLEDIL.js";import{a as se}from"./chunk-M35C5CZ3.js";import"./chunk-2SUYJOML.js";import{b as re,c as ie,f as oe,g as ae,h as T,i as le,k as ue,l as ce,m as de}from"./chunk-ESDP5647.js";import"./chunk-F33J3ELK.js";import{a as k,n as ne,p as m}from"./chunk-OEMHC5TT.js";import{g as U}from"./chunk-EQPD2MMQ.js";import"./chunk-YAXTLTJC.js";var y=class{},p=y;p.namespace="ebookExtension.",p.CFI_FRAGMENT_CHANGE=y.namespace+"cfiFragmentChange",p.ITEM_CLICKED=y.namespace+"itemClicked",p.LOADED_NAVIGATION=y.namespace+"loadedNavigation",p.RELOCATED=y.namespace+"relocated",p.RENDITION_ATTACHED=y.namespace+"renditionAttached",p.TOC_READY=y.namespace+"tocReady";function F(){var t=window,e=[];(!t.customElements||t.Element&&(!t.Element.prototype.closest||!t.Element.prototype.matches||!t.Element.prototype.remove))&&e.push(import("./dom-ITI5BMGR.js"));function n(){try{var r=new URL("b","http://a");return r.pathname="c%20d",r.href==="http://a/c%20d"&&r.searchParams}catch{return!1}}return(typeof Object.assign!="function"||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||t.NodeList&&!t.NodeList.prototype.forEach||!t.fetch||!n()||typeof WeakMap=="undefined")&&e.push(import("./core-js-66EU3Z5G.js")),Promise.all(e)}var je=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ue=function(t,e,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function l(c){try{s(r.next(c))}catch(d){a(d)}}function u(c){try{s(r.throw(c))}catch(d){a(d)}}function s(c){c.done?o(c.value):i(c.value).then(l,u)}s((r=r.apply(t,e||[])).next())})},Be=function(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(s){return function(c){return u([s,c])}}function u(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=s[0]&2?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1],o=s;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s=e.call(t,n)}catch(c){s=[6,c],i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Me=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],a=0,l=o.length;a<l;a++,i++)r[i]=o[a];return r};var B=0,M=!1,he=!1,S=window,g=document,f={$flags$:0,$resourcesUrl$:"",jmp:function(t){return t()},raf:function(t){return requestAnimationFrame(t)},ael:function(t,e,n,r){return t.addEventListener(e,n,r)},rel:function(t,e,n,r){return t.removeEventListener(e,n,r)}},Ge=function(){var t=!1;try{g.addEventListener("e",null,Object.defineProperty({},"passive",{get:function(){t=!0}}))}catch{}return t}(),ze=function(){try{return new CSSStyleSheet,!0}catch{}return!1}(),pe=new WeakMap,x=function(t){return pe.get(t)};var Ne=function(t){var e={$flags$:0,$hostElement$:t,$instanceValues$:new Map};return e.$onInstancePromise$=new Promise(function(n){return e.$onInstanceResolve$=n}),e.$onReadyPromise$=new Promise(function(n){return e.$onReadyResolve$=n}),t["s-p"]=[],t["s-rc"]=[],pe.set(t,e)},ve=function(t,e){return e in t},I=function(t){return console.error(t)},me=new Map,We=function(t,e,n){var r=t.$tagName$.replace(/-/g,"_"),i=t.$lazyBundleIds$,o=me.get(i);return o?o[r]:import("./"+i+".entry.js").then(function(a){return me.set(i,a),a[r]},I)},C=new Map,$e=[],L=[],O=[],Je=function(t,e){return function(n){t.push(n),M||(M=!0,e&&f.$flags$&4?z(G):f.raf(G))}},Qe=function(t){for(var e=0;e<t.length;e++)try{t[e](performance.now())}catch(n){I(n)}t.length=0},ge=function(t,e){for(var n=0,r=0;n<t.length&&(r=performance.now())<e;)try{t[n++](r)}catch(i){I(i)}n===t.length?t.length=0:n!==0&&t.splice(0,n)},G=function(){B++,Qe($e);var t=(f.$flags$&6)==2?performance.now()+10*Math.ceil(B*(1/22)):1/0;ge(L,t),ge(O,t),L.length>0&&(O.push.apply(O,L),L.length=0),(M=$e.length+L.length+O.length>0)?f.raf(G):B=0},z=function(t){return Promise.resolve().then(t)},qe=Je(L,!0),be={},N=function(t){return t=typeof t,t==="object"||t==="function"};var Ee=function(){return S.CSS&&S.CSS.supports&&S.CSS.supports("color","var(--c)")?Promise.resolve():import("./css-shim-978387b1-1e75855f-O4PYI7RC.js").then(function(){if(f.$cssShim$=S.__stencil_cssshim,f.$cssShim$)return f.$cssShim$.initShim()})};var Ye=function(t,e){return t!=null&&!N(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t},ye="hydrated",b=function(t,e){return e===void 0&&(e=""),function(){}},Ke=function(t,e){return function(){}},we=new WeakMap,Xe=function(t,e,n){var r=C.get(t);ze&&n?(r=r||new CSSStyleSheet,r.replace(e)):r=e,C.set(t,r)},Ze=function(t,e,n,r){var i=Pe(e.$tagName$),o=C.get(i);if(t=t.nodeType===11?t:g,o)if(typeof o=="string"){t=t.head||t;var a=we.get(t),l=void 0;if(a||we.set(t,a=new Set),!a.has(i)){{if(f.$cssShim$){l=f.$cssShim$.createHostStyle(r,i,o,!!(e.$flags$&10));var u=l["s-sc"];u&&(i=u,a=null)}else l=g.createElement("style"),l.innerHTML=o;t.insertBefore(l,t.querySelector("link"))}a&&a.add(i)}}else t.adoptedStyleSheets.includes(o)||(t.adoptedStyleSheets=Me(t.adoptedStyleSheets,[o]));return i},Ve=function(t,e,n){var r=b("attachStyles",e.$tagName$),i=Ze(t.getRootNode(),e,n,t);r()},Pe=function(t,e){return"sc-"+t},et=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=null,o=!1,a=!1,l=[],u=function(d){for(var h=0;h<d.length;h++)i=d[h],Array.isArray(i)?u(i):i!=null&&typeof i!="boolean"&&((o=typeof t!="function"&&!N(i))&&(i=String(i)),o&&a?l[l.length-1].$text$+=i:l.push(o?W(null,i):i),a=o)};if(u(n),e){var s=e.className||e.class;s&&(e.class=typeof s!="object"?s:Object.keys(s).filter(function(d){return s[d]}).join(" "))}var c=W(t,null);return c.$attrs$=e,l.length>0&&(c.$children$=l),c},W=function(t,e){var n={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return n.$attrs$=null,n},tt={},nt=function(t){return t&&t.$tag$===tt},Se=function(t,e,n,r,i,o){if(n!==r){var a=ve(t,e),l=e.toLowerCase();if(e==="class"){var u=t.classList,s=xe(n),c=xe(r);u.remove.apply(u,s.filter(function(v){return v&&!c.includes(v)})),u.add.apply(u,c.filter(function(v){return v&&!s.includes(v)}))}else if(e==="ref")r&&r(t);else if(!a&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):ve(S,l)?e=l.slice(2):e=l[2]+e.slice(3),n&&f.rel(t,e,n,!1),r&&f.ael(t,e,r,!1);else{var d=N(r);if((a||d&&r!==null)&&!i)try{if(t.tagName.includes("-"))t[e]=r;else{var h=r??"";e==="list"?a=!1:(n==null||t[e]!=h)&&(t[e]=h)}}catch{}r==null||r===!1?t.removeAttribute(e):(!a||o&4||i)&&!d&&(r=r===!0?"":r,t.setAttribute(e,r))}}},rt=/\s/,xe=function(t){return t?t.split(rt):[]},ke=function(t,e,n,r){var i=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,o=t&&t.$attrs$||be,a=e.$attrs$||be;for(r in o)r in a||Se(i,r,o[r],void 0,n,e.$flags$);for(r in a)Se(i,r,o[r],a[r],n,e.$flags$)},J=function(t,e,n,r){var i=e.$children$[n],o=0,a,l;if(i.$text$!==null)a=i.$elm$=g.createTextNode(i.$text$);else if(a=i.$elm$=g.createElement(i.$tag$),ke(null,i,he),i.$children$)for(o=0;o<i.$children$.length;++o)l=J(t,i,o),l&&a.appendChild(l);return a},Ie=function(t,e,n,r,i,o){for(var a=t,l;i<=o;++i)r[i]&&(l=J(null,n,i),l&&(r[i].$elm$=l,a.insertBefore(l,e)))},Le=function(t,e,n,r,i){for(;e<=n;++e)(r=t[e])&&(i=r.$elm$,De(r),i.remove())},it=function(t,e,n,r){for(var i=0,o=0,a=e.length-1,l=e[0],u=e[a],s=r.length-1,c=r[0],d=r[s],h;i<=a&&o<=s;)l==null?l=e[++i]:u==null?u=e[--a]:c==null?c=r[++o]:d==null?d=r[--s]:H(l,c)?(D(l,c),l=e[++i],c=r[++o]):H(u,d)?(D(u,d),u=e[--a],d=r[--s]):H(l,d)?(D(l,d),t.insertBefore(l.$elm$,u.$elm$.nextSibling),l=e[++i],d=r[--s]):H(u,c)?(D(u,c),t.insertBefore(u.$elm$,l.$elm$),u=e[--a],c=r[++o]):(h=J(e&&e[o],n,o),c=r[++o],h&&l.$elm$.parentNode.insertBefore(h,l.$elm$));i>a?Ie(t,r[s+1]==null?null:r[s+1].$elm$,n,r,o,s):o>s&&Le(e,i,a)},H=function(t,e){return t.$tag$===e.$tag$},D=function(t,e){var n=e.$elm$=t.$elm$,r=t.$children$,i=e.$children$;e.$text$===null?(ke(t,e,he),r!==null&&i!==null?it(n,r,e,i):i!==null?(t.$text$!==null&&(n.textContent=""),Ie(n,null,e,i,0,i.length-1)):r!==null&&Le(r,0,r.length-1)):t.$text$!==e.$text$&&(n.data=e.$text$)},De=function(t){t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.forEach(De)},ot=function(t,e,n,r){var i=e.$vnode$||W(null,null),o=nt(r)?r:et(null,null,r);o.$tag$=null,o.$flags$|=4,e.$vnode$=o,o.$elm$=i.$elm$=t,D(i,o)},Ae=function(t,e){e&&!t.$onRenderResolve$&&e["s-p"].push(new Promise(function(n){return t.$onRenderResolve$=n}))},R=function(t,e,n,r){if(e.$flags$|=16,e.$flags$&4){e.$flags$|=512;return}var i=b("scheduleUpdate",n.$tagName$),o=e.$ancestorComponent$,a=e.$lazyInstance$,l=function(){return at(t,e,n,a,r)};Ae(e,o);var u;return r&&(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.forEach(function(s){var c=s[0],d=s[1];return Te(a,c,d)}),e.$queuedListeners$=null)),i(),ut(u,function(){return qe(l)})},at=function(t,e,n,r,i){var o=b("update",n.$tagName$),a=t["s-rc"];i&&Ve(t,n,e.$modeName$);var l=b("render",n.$tagName$);try{ot(t,e,n,r.render())}catch(c){I(c)}f.$cssShim$&&f.$cssShim$.updateHost(t),e.$flags$&=~16,e.$flags$|=2,a&&(a.forEach(function(c){return c()}),t["s-rc"]=void 0),l(),o();{var u=t["s-p"],s=function(){return st(t,e,n)};u.length===0?s():(Promise.all(u).then(s),e.$flags$|=4,u.length=0)}},st=function(t,e,n){var r=b("postUpdate",n.$tagName$),i=e.$lazyInstance$,o=e.$ancestorComponent$;e.$flags$&64?(Te(i,"componentDidUpdate"),r()):(e.$flags$|=64,t.classList.add(ye),r(),e.$onReadyResolve$(t),o||_e()),e.$onInstanceResolve$(t),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),e.$flags$&512&&z(function(){return R(t,e,n,!1)}),e.$flags$&=~(4|512)},lt=function(t,e){{var n=x(t);(n.$flags$&(2|16))==2&&R(t,n,e,!1)}},_e=function(t){g.documentElement.classList.add(ye),f.$flags$|=2},Te=function(t,e,n){if(t&&t[e])try{return t[e](n)}catch(r){I(r)}},ut=function(t,e){return t&&t.then?t.then(e):e()},ct=function(t,e){return x(t).$instanceValues$.get(e)},dt=function(t,e,n,r){var i=x(t),o=i.$hostElement$,a=i.$instanceValues$.get(e),l=i.$flags$,u=i.$lazyInstance$;n=Ye(n,r.$members$[e][0]),n!==a&&(!(l&8)||a===void 0)&&(i.$instanceValues$.set(e,n),u&&(l&(2|16))==2&&R(o,i,r,!1))},Fe=function(t,e,n){if(e.$members$){var r=Object.entries(e.$members$),i=t.prototype;if(r.forEach(function(a){var l=a[0],u=a[1][0];u&31||n&2&&u&32?Object.defineProperty(i,l,{get:function(){return ct(this,l)},set:function(s){dt(this,l,s,e)},configurable:!0,enumerable:!0}):n&1&&u&64&&Object.defineProperty(i,l,{value:function(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];var d=x(this);return d.$onInstancePromise$.then(function(){var h;return(h=d.$lazyInstance$)[l].apply(h,s)})}})}),n&1){var o=new Map;i.attributeChangedCallback=function(a,l,u){var s=this;f.jmp(function(){var c=o.get(a);s[c]=u===null&&typeof s[c]=="boolean"?!1:u})},t.observedAttributes=r.filter(function(a){var l=a[0],u=a[1];return u[0]&15}).map(function(a){var l=a[0],u=a[1],s=u[1]||l;return o.set(s,l),s})}}return t},ft=function(t,e,n){e.$queuedListeners$=e.$queuedListeners$||[];var r=n.map(function(i){var o=i[0],a=i[1],l=i[2],u=pt(t,o),s=ht(e,l),c=vt(o);return f.ael(u,a,s,c),function(){return f.rel(u,a,s,c)}});return function(){return r.forEach(function(i){return i()})}},ht=function(t,e){return function(n){t.$flags$&256?t.$lazyInstance$[e](n):t.$queuedListeners$.push([e,n])}},pt=function(t,e){return e&8?S:t},vt=function(t){return Ge?{passive:(t&1)!=0,capture:(t&2)!=0}:(t&2)!=0},mt=function(t,e,n,r,i){return Ue(void 0,void 0,void 0,function(){var o,a,l,u,s,c,d;return Be(this,function(h){switch(h.label){case 0:return(e.$flags$&32)!=0?[3,3]:(e.$flags$|=32,i=We(n),i.then?(o=Ke(),[4,i]):[3,2]);case 1:i=h.sent(),o(),h.label=2;case 2:i.isProxied||(Fe(i,n,2),i.isProxied=!0),a=b("createInstance",n.$tagName$),e.$flags$|=8;try{new i(e)}catch(v){I(v)}e.$flags$&=~8,a(),l=Pe(n.$tagName$),!C.has(l)&&i.style&&(u=b("registerStyles",n.$tagName$),s=i.style,Xe(l,s,!!(n.$flags$&1)),u()),h.label=3;case 3:return c=e.$ancestorComponent$,d=function(){return R(t,e,n,!0)},c&&c["s-rc"]?c["s-rc"].push(d):d(),[2]}})})},$t=function(t,e){if((f.$flags$&1)==0){var n=b("connectedCallback",e.$tagName$),r=x(t);if(e.$listeners$&&(r.$rmListeners$=ft(t,r,e.$listeners$)),!(r.$flags$&1)){r.$flags$|=1;for(var i=t;i=i.parentNode||i.host;)if(i["s-p"]){Ae(r,r.$ancestorComponent$=i);break}e.$members$&&Object.entries(e.$members$).forEach(function(o){var a=o[0],l=o[1][0];if(l&31&&t.hasOwnProperty(a)){var u=t[a];delete t[a],t[a]=u}}),z(function(){return mt(t,r,e)})}n()}},gt=function(t){if((f.$flags$&1)==0){var e=x(t);e.$rmListeners$&&(e.$rmListeners$(),e.$rmListeners$=void 0),f.$cssShim$&&f.$cssShim$.removeHost(t)}},Ce=function(t,e){e===void 0&&(e={});var n=b(),r=[],i=e.exclude||[],o=g.head,a=S.customElements,l=o.querySelector("meta[charset]"),u=g.createElement("style"),s=[],c,d=!0;Object.assign(f,e),f.$resourcesUrl$=new URL(e.resourcesUrl||"./",g.baseURI).href,e.syncQueue&&(f.$flags$|=4),t.forEach(function(h){return h[1].forEach(function(v){var w={$flags$:v[0],$tagName$:v[1],$members$:v[2],$listeners$:v[3]};w.$members$=v[2],w.$listeners$=v[3];var _=w.$tagName$,Re=function(ee){je(P,ee);function P(E){var te=ee.call(this,E)||this;return E=te,Ne(E),te}return P.prototype.connectedCallback=function(){var E=this;c&&(clearTimeout(c),c=null),d?s.push(this):f.jmp(function(){return $t(E,w)})},P.prototype.disconnectedCallback=function(){var E=this;f.jmp(function(){return gt(E)})},P.prototype["s-hmr"]=function(E){},P.prototype.forceUpdate=function(){lt(this,w)},P.prototype.componentOnReady=function(){return x(this).$onReadyPromise$},P}(HTMLElement);w.$lazyBundleIds$=h[0],!i.includes(_)&&!a.get(_)&&(r.push(_),a.define(_,Fe(Re,w,1)))})}),u.innerHTML=r+"{visibility:hidden}.hydrated{visibility:inherit}",u.setAttribute("data-styles",""),o.insertBefore(u,l?l.nextSibling:o.firstChild),d=!1,s.length>0?s.forEach(function(h){return h.connectedCallback()}):f.jmp(function(){return c=setTimeout(_e,30,"timeout")}),n()};var j=function(t,e){return Ee().then(function(){Ce([["uv-ebook-reader_2",[[0,"uv-ebook-reader",{width:[1],height:[1],mobileWidth:[2,"mobile-width"],minSpreadWidth:[2,"min-spread-width"],_bookPath:[32],_bookReady:[32],_prevEnabled:[32],_mobile:[32],_nextEnabled:[32],_showDivider:[32],load:[64],resize:[64],display:[64],getBook:[64]},[[8,"keydown","handleKeyDown"]]],[0,"uv-ebook-toc",{toc:[16],selected:[1025],disabled:[4]}]]]],e)})};(function(){if(!(window.Reflect===void 0||window.customElements===void 0)){var t=HTMLElement;window.HTMLElement=function(){return Reflect.construct(t,[],this.constructor)},HTMLElement.prototype=t.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,t)}})();var Oe=window.$,Q=class extends ae{constructor(e){super(e)}async create(){this.setConfig("ebookLeftPanel"),super.create(),this._$container=Oe('<div class="container"></div>'),await F(),j(window),this._ebookTOC=document.createElement("uv-ebook-toc"),this._$ebookTOC=Oe(this._ebookTOC),this.$main.addClass("disabled"),this.$main.append(this._$container),this._$container.append(this._$ebookTOC),this.setTitle(this.content.title),this.extensionHost.subscribe(p.LOADED_NAVIGATION,e=>{this.$main.removeClass("disabled"),this._ebookTOC.toc=e.toc}),this.extensionHost.subscribe(p.RELOCATED,e=>{this._ebookTOC.selected=e.start.href}),this._ebookTOC.addEventListener("itemClicked",e=>{this.extensionHost.publish(p.ITEM_CLICKED,e.detail)},!1),k.waitFor(()=>window.customElements!==void 0,()=>{customElements.whenDefined("uv-ebook-toc").then(()=>{this.extensionHost.publish(p.TOC_READY)})})}expandFullStart(){super.expandFullStart(),this.extensionHost.publish(m.LEFTPANEL_EXPAND_FULL_START)}expandFullFinish(){super.expandFullFinish(),this.extensionHost.publish(m.LEFTPANEL_EXPAND_FULL_FINISH)}collapseFullStart(){super.collapseFullStart(),this.extensionHost.publish(m.LEFTPANEL_COLLAPSE_FULL_START)}collapseFullFinish(){super.collapseFullFinish(),this.extensionHost.publish(m.LEFTPANEL_COLLAPSE_FULL_FINISH)}resize(){super.resize(),this._$container.height(this.$main.height()-this._$container.verticalPadding())}};var q=class extends se{constructor(e){super(e)}create(){this.setConfig("downloadDialogue"),super.create()}open(e){super.open(e),this.addEntireFileDownloadOptions(),this.updateNoneAvailable(),this.resize()}isDownloadOptionAvailable(e){return super.isDownloadOptionAvailable(e)}};var Y=class extends ie{constructor(e){super(e);this._ebookReaderReady=!1;this._state={};this._prevState={};this.attributionPosition=re.BOTTOM_RIGHT}async create(){this.setConfig("ebookCenterPanel"),super.create(),await F(),j(window),this._ebookReader=document.createElement("uv-ebook-reader"),this.$content.prepend(this._ebookReader),this._ebookReader.setAttribute("width","100%"),this._ebookReader.setAttribute("height","100%"),this._ebookReader.addEventListener("loadedNavigation",n=>{this.extensionHost.publish(p.LOADED_NAVIGATION,n.detail)},!1),this._ebookReader.addEventListener("relocated",n=>{this.extensionHost.publish(p.RELOCATED,n.detail),this._cfi=n.detail.start.cfi,this.extensionHost.publish(p.CFI_FRAGMENT_CHANGE,this._cfi)},!1),k.waitFor(()=>window.customElements!==void 0,()=>{customElements.whenDefined("uv-ebook-reader").then(()=>{this._ebookReaderReady=!0})});let e=this;this.extensionHost.subscribe(m.OPEN_EXTERNAL_RESOURCE,n=>{e.openMedia(n)}),this.extensionHost.subscribe(p.ITEM_CLICKED,n=>{this._nextState({cfi:n})}),this.extensionHost.subscribe(p.CFI_FRAGMENT_CHANGE,n=>{k.waitFor(()=>this._ebookReaderReady,()=>{n!==this._cfi&&this._nextState({cfi:n})})})}openMedia(e){this.extension.getExternalResources(e).then(()=>{let r=this.extension.helper.getCurrentCanvas().getContent();if(r.length){let o=r[0].getBody();if(o.length){let a=o[0];this._nextState({bookPath:a.id})}}this.extensionHost.publish(U.EXTERNAL_RESOURCE_OPENED),this.extensionHost.publish(U.LOAD)})}_nextState(e){this._state=Object.assign({},this._state,e),k.waitFor(()=>this._ebookReaderReady,()=>{this._state.bookPath&&this._state.bookPath!==this._prevState.bookPath&&this._ebookReader.load(this._state.bookPath),this._state.cfi&&this._state.cfi!==this._prevState.cfi&&this._ebookReader.display(this._state.cfi),this._prevState=Object.assign({},this._state)})}resize(){super.resize(),this._ebookReaderReady&&setTimeout(()=>{this._ebookReader.resize()},10)}};var K=class extends T{constructor(e){super(e)}create(){this.setConfig("mobileFooterPanel"),super.create()}resize(){super.resize(),this.$options.css("left",Math.floor(this.$element.width()/2-this.$options.width()/2))}};var X=class extends ce{constructor(e){super(e)}create(){this.setConfig("settingsDialogue"),super.create()}};var Z=class extends de{constructor(e){super(e)}create(){this.setConfig("shareDialogue"),super.create()}update(){super.update(),this.code=this.extension.getEmbedScript(this.options.embedTemplate,this.currentWidth,this.currentHeight),this.$code.val(this.code)}resize(){super.resize()}};var bt={allowStealFocus:!1,authAPIVersion:1,bookmarkThumbHeight:150,bookmarkThumbWidth:90,dropEnabled:!0,footerPanelEnabled:!0,headerPanelEnabled:!0,leftPanelEnabled:!0,limitLocales:!1,metrics:[{type:"sm",minWidth:0},{type:"md",minWidth:768},{type:"lg",minWidth:1024},{type:"xl",minWidth:1280}],multiSelectionMimeType:"application/zip",navigatorEnabled:!0,openTemplate:"http://universalviewer.io?manifest={0}",overrideFullScreen:!1,pagingEnabled:!0,pagingOptionEnabled:!0,pessimisticAccessControl:!1,preserveViewport:!1,rightPanelEnabled:!0,saveUserSettings:!1,clickToZoomEnabled:!0,searchWithinEnabled:!0,termsOfUseEnabled:!1,theme:"uv-en-GB-theme",tokenStorage:"session",useArrowKeysToNavigate:!1,zoomToSearchResultEnabled:!0},Et={ebookLeftPanel:{options:{expandFullEnabled:!1,panelAnimationDuration:250,panelCollapsedWidth:30,panelExpandedWidth:255},content:{title:"Contents"}},dialogue:{topCloseButtonEnabled:!1,content:{close:"Close"}},footerPanel:{options:{bookmarkEnabled:!1,downloadEnabled:!0,embedEnabled:!1,feedbackEnabled:!1,fullscreenEnabled:!0,minimiseButtons:!0,moreInfoEnabled:!0,openEnabled:!1,printEnabled:!1,shareEnabled:!0},content:{bookmark:"Add to bookmarks",download:"Download",embed:"Embed",exitFullScreen:"Exit Full Screen",feedback:"Feedback",fullScreen:"Full Screen",moreInfo:"More Information",open:"Open",share:"Share"}},genericDialogue:{content:{emptyValue:"please enter a value.",invalidNumber:"Please enter a valid number.",noMatches:"No matches were found.",ok:"OK",pageNotFound:"This item does not contain a page with the number you entered. Try switching the numbering mode to 'image'.",refresh:"Refresh"}},headerPanel:{options:{localeToggleEnabled:!1,settingsButtonEnabled:!0},content:{settings:"Settings"}},helpDialogue:{content:{text:"placeholder text",title:"Help"}},moreInfoRightPanel:{options:{canvasDisplayOrder:"",canvasExclude:"",copyToClipboardEnabled:!1,manifestDisplayOrder:"",manifestExclude:"",panelAnimationDuration:250,panelCollapsedWidth:30,panelExpandedWidth:255,panelOpen:!1,rtlLanguageCodes:"ar, ara, dv, div, he, heb, ur, urd",showAllLanguages:!1,textLimit:4,textLimitType:"lines",limitToRange:!1},content:{attribution:"Attribution",collapse:"Collapse Information",collapseFull:"Collapse Gallery",description:"Description",expand:"Expand Information",expandFull:"Expand Gallery",holdingText:"Your module goes here!",less:"less",license:"License",logo:"Logo",more:"more",noData:"No data to display",page:"Page",title:"More Information",manifestHeader:"About the item",canvasHeader:"About the image",copyToClipboard:"Copy to clipboard",copiedToClipboard:"Copied to clipboard"}},ebookCenterPanel:{options:{}},settingsDialogue:{content:{locale:"Locale",navigatorEnabled:"Navigator Enabled",clickToZoomEnabled:"Mouse Click To Zoom",pagingEnabled:"Two Page View",reducedMotion:"Reduce motion (disables animations)",preserveViewport:"Preserve Zoom",title:"Settings",website:"<a href='https://github.com/universalviewer/universalviewer#contributors'>more info</a>"}},shareDialogue:{options:{embedTemplate:'<iframe src="{0}" width="{1}" height="{2}" allowfullscreen frameborder="0"></iframe>',instructionsEnabled:!1,shareFrameEnabled:!0},content:{customSize:"custom",embed:"Embed",embedInstructions:"To embed this item in your own website, copy and paste the code below.",height:"Height",iiif:"IIIF Manifest",share:"Share",shareInstructions:"To share this item, copy the URL below.",size:"Size:",width:"Width"}},authDialogue:{content:{cancel:"Cancel",confirm:"Confirm"}},clickThroughDialogue:{content:{viewTerms:"Read Full Terms and Conditions"}},downloadDialogue:{content:{currentViewAsJpg:"Current view {0} x {1}px (jpg)",currentViewAsJpgExplanation:"Opens in a new window",download:"Download",downloadSelection:"Download Selection",downloadSelectionExplanation:"Opens a dialogue to select which pages to download.",editSettings:"Edit Settings",entireDocument:"Entire document ({0})",entireFileAsOriginal:"Entire file",entireFileAsOriginalWithFormat:"Entire file ({0})",noneAvailable:"No download options are available.",pagingNote:"Please turn off Two Page View for additional options.",preview:"Preview",title:"Download",wholeImageHighRes:"Whole image {0} x {1}px ({2})",wholeImageHighResExplanation:"Opens in a new window.",wholeImagesHighRes:"Whole images ({0})",wholeImagesHighResExplanation:"Opens in two new windows.",wholeImageLowResAsJpg:"Whole image {0} x {1}px (jpg)",wholeImageLowResAsJpgExplanation:"Opens in a new window."}},loginDialogue:{content:{login:"Login",logout:"Logout",cancel:"Cancel"}},avCenterPanel:{content:{attribution:"Attribution"}},restrictedDialogue:{content:{cancel:"Cancel"}}},yt={label:"English (GB)",locales:[{name:"cy-GB",label:"Cymraeg"},{name:"en-GB",label:"English (GB)"},{name:"fr-FR",label:"Fran\xE7ais (FR)"},{name:"pl-PL",label:"Polski"},{name:"sv-SE",label:"Svenska"}]},wt={authCORSError:"Your browser does not support CORS, please upgrade to view this content.",authorisationFailedMessage:"Your log-in attempt did not appear to be successful. Please try again.",canvasIndexOutOfRange:"Canvas index out of range.",fallbackDegradedLabel:"Login",fallbackDegradedMessage:"Please log in to view this content at full resolution.",forbiddenResourceMessage:"Your current access rights are insufficient to view this image",termsOfUse:"Terms of Use",mediaViewer:"Media Viewer",skipToDownload:"Skip to downloads and alternative formats"},V={options:bt,modules:Et,localisation:yt,content:wt};var He=class extends oe{constructor(){super(...arguments);this.defaultConfig=V;this.locales={"en-GB":V,"cy-GB":()=>import("./cy-GB-LTUUSXSY.js"),"fr-FR":()=>import("./fr-FR-DKL5MCZE.js"),"pl-PL":()=>import("./pl-PL-7Q76AJED.js"),"sv-SE":()=>import("./sv-SE-PBF7APYM.js")}}create(){super.create(),this.extensionHost.subscribe(m.CANVAS_INDEX_CHANGE,e=>{this.viewCanvas(e)}),this.extensionHost.subscribe(p.CFI_FRAGMENT_CHANGE,e=>{this.cfiFragement=e,this.fire(p.CFI_FRAGMENT_CHANGE,this.cfiFragement)})}createModules(){super.createModules(),this.isHeaderPanelEnabled()?this.headerPanel=new le(this.shell.$headerPanel):this.shell.$headerPanel.hide(),this.isLeftPanelEnabled()?this.leftPanel=new Q(this.shell.$leftPanel):this.shell.$leftPanel.hide(),this.centerPanel=new Y(this.shell.$centerPanel),this.isRightPanelEnabled()?this.rightPanel=new ue(this.shell.$rightPanel):this.shell.$rightPanel.hide(),this.isFooterPanelEnabled()?(this.footerPanel=new T(this.shell.$footerPanel),this.mobileFooterPanel=new K(this.shell.$mobileFooterPanel)):this.shell.$footerPanel.hide(),this.$moreInfoDialogue=$('<div class="overlay moreInfo" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$moreInfoDialogue),this.moreInfoDialogue=new fe(this.$moreInfoDialogue),this.$shareDialogue=$('<div class="overlay share" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$shareDialogue),this.shareDialogue=new Z(this.$shareDialogue),this.$downloadDialogue=$('<div class="overlay download" aria-hidden="true" role="region"></div>'),this.shell.$overlays.append(this.$downloadDialogue),this.downloadDialogue=new q(this.$downloadDialogue),this.$settingsDialogue=$('<div class="overlay settings" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$settingsDialogue),this.settingsDialogue=new X(this.$settingsDialogue),this.isHeaderPanelEnabled()&&this.headerPanel.init(),this.isLeftPanelEnabled()&&this.leftPanel.init(),this.isRightPanelEnabled()&&this.rightPanel.init(),this.isFooterPanelEnabled()&&this.footerPanel.init()}isLeftPanelEnabled(){return!0}render(){super.render(),this.checkForCFIParam()}getEmbedScript(e,n,r){let o=`${this.getAppUri()}#?manifest=${this.helper.manifestUri}&cfi=${this.cfiFragement}`;return ne.format(e,o,n.toString(),r.toString())}checkForCFIParam(){let e=this.data.cfi;e&&this.extensionHost.publish(p.CFI_FRAGMENT_CHANGE,e)}};export{He as default};
