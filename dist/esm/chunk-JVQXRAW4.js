import{b as k,c as b}from"./chunk-YAXTLTJC.js";var H=k(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});var tt;(function(o){o.BOOKMARKING="oa:bookmarking",o.CLASSIFYING="oa:classifying",o.COMMENTING="oa:commenting",o.DESCRIBING="oa:describing",o.EDITING="oa:editing",o.HIGHLIGHTING="oa:highlighting",o.IDENTIFYING="oa:identifying",o.LINKING="oa:linking",o.MODERATING="oa:moderating",o.PAINTING="sc:painting",o.QUESTIONING="oa:questioning",o.REPLYING="oa:replying",o.TAGGING="oa:tagging",o.TRANSCRIBING="oad:transcribing"})(tt=C.AnnotationMotivation||(C.AnnotationMotivation={}));var et;(function(o){o.AUTO_ADVANCE="auto-advance",o.CONTINUOUS="continuous",o.FACING_PAGES="facing-pages",o.HIDDEN="hidden",o.INDIVIDUALS="individuals",o.MULTI_PART="multi-part",o.NO_NAV="no-nav",o.NON_PAGED="non-paged",o.PAGED="paged",o.REPEAT="repeat",o.SEQUENCE="sequence",o.THUMBNAIL_NAV="thumbnail-nav",o.TOGETHER="together",o.UNORDERED="unordered"})(et=C.Behavior||(C.Behavior={}));var nt;(function(o){o.CANVAS="canvas",o.CHOICE="choice",o.OA_CHOICE="oa:choice",o.CONTENT_AS_TEXT="contentastext",o.DATASET="dataset",o.DOCUMENT="document",o.IMAGE="image",o.MODEL="model",o.MOVING_IMAGE="movingimage",o.PDF="pdf",o.PHYSICAL_OBJECT="physicalobject",o.SOUND="sound",o.TEXT="text",o.TEXTUALBODY="textualbody",o.VIDEO="video"})(nt=C.ExternalResourceType||(C.ExternalResourceType={}));var it;(function(o){o.ANNOTATION="annotation",o.CANVAS="canvas",o.COLLECTION="collection",o.MANIFEST="manifest",o.RANGE="range",o.SEQUENCE="sequence"})(it=C.IIIFResourceType||(C.IIIFResourceType={}));var rt;(function(o){o.AUDIO_MP4="audio/mp4",o.CORTO="application/corto",o.DICOM="application/dicom",o.DRACO="application/draco",o.EPUB="application/epub+zip",o.GIRDER="image/vnd.kitware.girder",o.GLB="model/gltf-binary",o.GLTF="model/gltf+json",o.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',o.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',o.JPG="image/jpeg",o.M3U8="application/vnd.apple.mpegurl",o.MP3="audio/mp3",o.MPEG_DASH="application/dash+xml",o.OBJ="text/plain",o.OPF="application/oebps-package+xml",o.PDF="application/pdf",o.PLY="application/ply",o.THREEJS="application/vnd.threejs+json",o.USDZ="model/vnd.usd+zip",o.VIDEO_MP4="video/mp4",o.WAV="audio/wav",o.WEBM="video/webm"})(rt=C.MediaType||(C.MediaType={}));var ot;(function(o){o.DOC="application/msword",o.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",o.PDF="application/pdf"})(ot=C.RenderingFormat||(C.RenderingFormat={}));var at;(function(o){o.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",o.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",o.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",o.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",o.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",o.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",o.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",o.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",o.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",o.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",o.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",o.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",o.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",o.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",o.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",o.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",o.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",o.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",o.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",o.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",o.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",o.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",o.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",o.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",o.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",o.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",o.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",o.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",o.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",o.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",o.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",o.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",o.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",o.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",o.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",o.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",o.SEARCH_0="http://iiif.io/api/search/0/search",o.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",o.SEARCH_1="http://iiif.io/api/search/1/search",o.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",o.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",o.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",o.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",o.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",o.DOWNLOAD_EXTENSIONS="http://universalviewer.io/download-extensions-profile",o.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",o.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"})(at=C.ServiceProfile||(C.ServiceProfile={}));var st;(function(o){o.IMAGE_SERVICE_2="ImageService2",o.IMAGE_SERVICE_3="ImageService3"})(st=C.ServiceType||(C.ServiceType={}));var ut;(function(o){o.BOTTOM_TO_TOP="bottom-to-top",o.LEFT_TO_RIGHT="left-to-right",o.RIGHT_TO_LEFT="right-to-left",o.TOP_TO_BOTTOM="top-to-bottom"})(ut=C.ViewingDirection||(C.ViewingDirection={}));var lt;(function(o){o.CONTINUOUS="continuous",o.INDIVIDUALS="individuals",o.NON_PAGED="non-paged",o.PAGED="paged",o.TOP="top"})(lt=C.ViewingHint||(C.ViewingHint={}))});var G=k((x,q)=>{(function(o,e){typeof x=="object"&&typeof q=="object"?q.exports=e():typeof define=="function"&&define.amd?define("manifesto",[],e):typeof x=="object"?x.manifesto=e():o.manifesto=e()})(typeof self!="undefined"?self:x,function(){return function(o){var e={};function r(n){if(e[n])return e[n].exports;var c=e[n]={i:n,l:!1,exports:{}};return o[n].call(c.exports,c,c.exports,r),c.l=!0,c.exports}return r.m=o,r.c=e,r.d=function(n,c,l){r.o(n,c)||Object.defineProperty(n,c,{enumerable:!0,get:l})},r.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,c){if(1&c&&(n=r(n)),8&c||4&c&&typeof n=="object"&&n&&n.__esModule)return n;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:n}),2&c&&typeof n!="string")for(var s in n)r.d(l,s,function(p){return n[p]}.bind(null,s));return l},r.n=function(n){var c=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(c,"a",c),c},r.o=function(n,c){return Object.prototype.hasOwnProperty.call(n,c)},r.p="",r(r.s=7)}([function(o,e,r){"use strict";function n(c){for(var l in c)e.hasOwnProperty(l)||(e[l]=c[l])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(9)),n(r(10)),n(r(11)),n(r(12)),n(r(13)),n(r(14)),n(r(15)),n(r(16)),n(r(17)),n(r(31)),n(r(32)),n(r(33)),n(r(34)),n(r(35)),n(r(38)),n(r(39)),n(r(40)),n(r(41)),n(r(42)),n(r(43)),n(r(44)),n(r(45)),n(r(46)),n(r(47)),n(r(48)),n(r(49)),n(r(50)),n(r(3))},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(n){n.BOOKMARKING="oa:bookmarking",n.CLASSIFYING="oa:classifying",n.COMMENTING="oa:commenting",n.DESCRIBING="oa:describing",n.EDITING="oa:editing",n.HIGHLIGHTING="oa:highlighting",n.IDENTIFYING="oa:identifying",n.LINKING="oa:linking",n.MODERATING="oa:moderating",n.PAINTING="sc:painting",n.QUESTIONING="oa:questioning",n.REPLYING="oa:replying",n.TAGGING="oa:tagging",n.TRANSCRIBING="oad:transcribing"}(e.AnnotationMotivation||(e.AnnotationMotivation={})),function(n){n.AUTO_ADVANCE="auto-advance",n.CONTINUOUS="continuous",n.FACING_PAGES="facing-pages",n.HIDDEN="hidden",n.INDIVIDUALS="individuals",n.MULTI_PART="multi-part",n.NO_NAV="no-nav",n.NON_PAGED="non-paged",n.PAGED="paged",n.REPEAT="repeat",n.SEQUENCE="sequence",n.THUMBNAIL_NAV="thumbnail-nav",n.TOGETHER="together",n.UNORDERED="unordered"}(e.Behavior||(e.Behavior={})),function(n){n.CANVAS="canvas",n.CHOICE="choice",n.OA_CHOICE="oa:choice",n.CONTENT_AS_TEXT="contentastext",n.DATASET="dataset",n.DOCUMENT="document",n.IMAGE="image",n.MODEL="model",n.MOVING_IMAGE="movingimage",n.PDF="pdf",n.PHYSICAL_OBJECT="physicalobject",n.SOUND="sound",n.TEXT="text",n.TEXTUALBODY="textualbody",n.VIDEO="video"}(e.ExternalResourceType||(e.ExternalResourceType={})),function(n){n.ANNOTATION="annotation",n.CANVAS="canvas",n.COLLECTION="collection",n.MANIFEST="manifest",n.RANGE="range",n.SEQUENCE="sequence"}(e.IIIFResourceType||(e.IIIFResourceType={})),function(n){n.AUDIO_MP4="audio/mp4",n.CORTO="application/corto",n.DICOM="application/dicom",n.DRACO="application/draco",n.EPUB="application/epub+zip",n.GIRDER="image/vnd.kitware.girder",n.GLB="model/gltf-binary",n.GLTF="model/gltf+json",n.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',n.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',n.JPG="image/jpeg",n.M3U8="application/vnd.apple.mpegurl",n.MP3="audio/mp3",n.MPEG_DASH="application/dash+xml",n.OBJ="text/plain",n.OPF="application/oebps-package+xml",n.PDF="application/pdf",n.PLY="application/ply",n.THREEJS="application/vnd.threejs+json",n.USDZ="model/vnd.usd+zip",n.VIDEO_MP4="video/mp4",n.WAV="audio/wav",n.WEBM="video/webm"}(e.MediaType||(e.MediaType={})),function(n){n.DOC="application/msword",n.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",n.PDF="application/pdf"}(e.RenderingFormat||(e.RenderingFormat={})),function(n){n.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",n.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",n.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",n.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",n.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",n.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",n.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",n.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",n.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",n.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",n.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",n.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",n.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",n.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",n.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",n.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",n.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",n.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",n.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",n.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",n.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",n.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",n.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",n.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",n.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",n.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",n.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",n.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",n.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",n.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",n.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",n.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",n.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",n.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",n.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",n.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",n.SEARCH_0="http://iiif.io/api/search/0/search",n.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",n.SEARCH_1="http://iiif.io/api/search/1/search",n.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",n.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",n.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",n.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",n.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",n.DOWNLOAD_EXTENSIONS="http://universalviewer.io/download-extensions-profile",n.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",n.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(e.ServiceProfile||(e.ServiceProfile={})),function(n){n.IMAGE_SERVICE_2="ImageService2",n.IMAGE_SERVICE_3="ImageService3"}(e.ServiceType||(e.ServiceType={})),function(n){n.BOTTOM_TO_TOP="bottom-to-top",n.LEFT_TO_RIGHT="left-to-right",n.RIGHT_TO_LEFT="right-to-left",n.TOP_TO_BOTTOM="top-to-bottom"}(e.ViewingDirection||(e.ViewingDirection={})),function(n){n.CONTINUOUS="continuous",n.INDIVIDUALS="individuals",n.NON_PAGED="non-paged",n.PAGED="paged",n.TOP="top"}(e.ViewingHint||(e.ViewingHint={}))},function(o,e,r){var n=r(21).Symbol;o.exports=n},function(o,e,r){"use strict";var n=this&&this.__awaiter||function(i,t,a,u){return new(a||(a=Promise))(function(f,g){function _(y){try{E(u.next(y))}catch(d){g(d)}}function v(y){try{E(u.throw(y))}catch(d){g(d)}}function E(y){var d;y.done?f(y.value):(d=y.value,d instanceof a?d:new a(function(T){T(d)})).then(_,v)}E((u=u.apply(i,t||[])).next())})},c=this&&this.__generator||function(i,t){var a,u,f,g,_={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return g={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function v(E){return function(y){return function(d){if(a)throw new TypeError("Generator is already executing.");for(;_;)try{if(a=1,u&&(f=2&d[0]?u.return:d[0]?u.throw||((f=u.return)&&f.call(u),0):u.next)&&!(f=f.call(u,d[1])).done)return f;switch(u=0,f&&(d=[2&d[0],f.value]),d[0]){case 0:case 1:f=d;break;case 4:return _.label++,{value:d[1],done:!1};case 5:_.label++,u=d[1],d=[0];continue;case 7:d=_.ops.pop(),_.trys.pop();continue;default:if(!(f=(f=_.trys).length>0&&f[f.length-1])&&(d[0]===6||d[0]===2)){_=0;continue}if(d[0]===3&&(!f||d[1]>f[0]&&d[1]<f[3])){_.label=d[1];break}if(d[0]===6&&_.label<f[1]){_.label=f[1],f=d;break}if(f&&_.label<f[2]){_.label=f[2],_.ops.push(d);break}f[2]&&_.ops.pop(),_.trys.pop();continue}d=t.call(i,_)}catch(T){d=[6,T],u=0}finally{a=f=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([E,y])}}};Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=r(1),p=r(36);r(37);var h=function(){function i(){}return i.getMediaType=function(t){return(t=(t=t.toLowerCase()).split(";")[0]).trim()},i.getImageQuality=function(t){return t===s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1||t===s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2||t===s.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1||t===s.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2||t===s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1||t===s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2||t===s.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1||t===s.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2||t===s.ServiceProfile.IMAGE_1_LEVEL_1||t===s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1||t===s.ServiceProfile.IMAGE_1_LEVEL_2||t===s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},i.getInexactLocale=function(t){return t.indexOf("-")!==-1?t.substr(0,t.indexOf("-")):t},i.getLocalisedValue=function(t,a){if(!Array.isArray(t))return t;for(var u=0;u<t.length;u++){var f=t[u];if(a===f["@language"])return f["@value"]}var g=a.substr(0,a.indexOf("-"));for(u=0;u<t.length;u++){var _=t[u];if(_["@language"]===g)return _["@value"]}return null},i.generateTreeNodeIds=function(t,a){var u;a===void 0&&(a=0),u=t.parentNode?t.parentNode.id+"-"+a:"0",t.id=u;for(var f=0;f<t.nodes.length;f++){var g=t.nodes[f];i.generateTreeNodeIds(g,f)}},i.normaliseType=function(t){return(t=(t||"").toLowerCase()).indexOf(":")!==-1?t.split(":")[1]:t},i.normaliseUrl=function(t){return(t=t.substr(t.indexOf("://"))).indexOf("#")!==-1&&(t=t.split("#")[0]),t},i.normalisedUrlsMatch=function(t,a){return i.normaliseUrl(t)===i.normaliseUrl(a)},i.isImageProfile=function(t){return!!(i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},i.isImageServiceType=function(t){return t!==null&&t.toLowerCase()===s.ServiceType.IMAGE_SERVICE_2.toLowerCase()||t===s.ServiceType.IMAGE_SERVICE_3.toLowerCase()},i.isLevel0ImageProfile=function(t){return!!(i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_LEVEL_0)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0))},i.isLevel1ImageProfile=function(t){return!!(i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_LEVEL_1)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1))},i.isLevel2ImageProfile=function(t){return!!(i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_LEVEL_2)||i.normalisedUrlsMatch(t,s.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},i.parseManifest=function(t,a){return l.Deserialiser.parse(t,a)},i.checkStatus=function(t){if(t.ok)return t;var a=new Error(t.statusText);return a.response=t,Promise.reject(a)},i.loadManifest=function(t){return new Promise(function(a,u){fetch(t).then(i.checkStatus).then(function(f){return f.json()}).then(function(f){a(f)}).catch(function(f){u()})})},i.loadExternalResourcesAuth1=function(t,a,u,f,g,_,v,E){return new Promise(function(y,d){var T=t.map(function(I){return i.loadExternalResourceAuth1(I,a,u,f,g,_,v,E)});Promise.all(T).then(function(){y(t)}).catch(function(I){d(I)})})},i.loadExternalResourceAuth1=function(t,a,u,f,g,_,v,E){return n(this,void 0,void 0,function(){var y;return c(this,function(d){switch(d.label){case 0:return[4,f(t)];case 1:return(y=d.sent())?[4,t.getData(y)]:[3,6];case 2:return d.sent(),t.status!==p.OK?[3,3]:[2,t];case 3:return[4,i.doAuthChain(t,a,u,g,_,v,E)];case 4:d.sent(),d.label=5;case 5:if(t.status===p.OK||t.status===p.MOVED_TEMPORARILY)return[2,t];throw i.createAuthorizationFailedError();case 6:return[4,t.getData()];case 7:return d.sent(),t.status!==p.MOVED_TEMPORARILY&&t.status!==p.UNAUTHORIZED?[3,9]:[4,i.doAuthChain(t,a,u,g,_,v,E)];case 8:d.sent(),d.label=9;case 9:if(t.status===p.OK||t.status===p.MOVED_TEMPORARILY)return[2,t];throw i.createAuthorizationFailedError()}})})},i.doAuthChain=function(t,a,u,f,g,_,v){return n(this,void 0,void 0,function(){var E,y,d,T,I,m,A,M;return c(this,function(R){switch(R.label){case 0:return t.isAccessControlled()?((E=t.externalService)&&(E.options=t.options),(y=t.kioskService)&&(y.options=t.options),(d=t.clickThroughService)&&(d.options=t.options),(T=t.loginService)&&(T.options=t.options),t.isResponseHandled||t.status!==p.MOVED_TEMPORARILY?[3,2]:[4,_(t)]):[2,t];case 1:return R.sent(),[2,t];case 2:return I=null,m=null,(I=E)?(m=I,[4,i.attemptResourceWithToken(t,u,I)]):[3,4];case 3:return R.sent(),[2,t];case 4:return(I=y)?(m=I,(A=a(I))?[4,f(A)]:[3,7]):[3,7];case 5:return R.sent(),[4,i.attemptResourceWithToken(t,u,I)];case 6:return R.sent(),[2,t];case 7:return(I=d)?(m=I,[4,g(t,I)]):[3,11];case 8:return(M=R.sent())?[4,f(M)]:[3,11];case 9:return R.sent(),[4,i.attemptResourceWithToken(t,u,I)];case 10:return R.sent(),[2,t];case 11:return(I=T)?(m=I,[4,g(t,I)]):[3,15];case 12:return(M=R.sent())?[4,f(M)]:[3,15];case 13:return R.sent(),[4,i.attemptResourceWithToken(t,u,I)];case 14:return R.sent(),[2,t];case 15:return m&&v(t,m),[2]}})})},i.attemptResourceWithToken=function(t,a,u){return n(this,void 0,void 0,function(){var f,g;return c(this,function(_){switch(_.label){case 0:return(f=u.getService(s.ServiceProfile.AUTH_1_TOKEN))?[4,a(t,f)]:[3,3];case 1:return(g=_.sent())&&g.accessToken?[4,t.getData(g)]:[3,3];case 2:return _.sent(),[2,t];case 3:return[2]}})})},i.loadExternalResourcesAuth09=function(t,a,u,f,g,_,v,E,y,d){return new Promise(function(T,I){var m=t.map(function(A){return i.loadExternalResourceAuth09(A,a,u,f,g,_,v,E,y,d)});Promise.all(m).then(function(){T(t)}).catch(function(A){I(A)})})},i.loadExternalResourceAuth09=function(t,a,u,f,g,_,v,E,y,d){return new Promise(function(T,I){d&&d.pessimisticAccessControl?t.getData().then(function(){t.isAccessControlled()?t.clickThroughService?(T(u(t)),T(f(t))):g(t).then(function(){_(t,!0).then(function(m){t.getData(m).then(function(){T(y(t))}).catch(function(A){I(i.createInternalServerError(A))})}).catch(function(m){I(i.createInternalServerError(m))})}).catch(function(m){I(i.createInternalServerError(m))}):T(t)}).catch(function(m){I(i.createInternalServerError(m))}):E(t,a).then(function(m){m?t.getData(m).then(function(){t.status===p.OK?T(y(t)):i.authorize(t,a,u,f,g,_,v,E).then(function(){T(y(t))}).catch(function(A){I(i.createAuthorizationFailedError())})}).catch(function(A){I(i.createAuthorizationFailedError())}):i.authorize(t,a,u,f,g,_,v,E).then(function(){T(y(t))}).catch(function(A){I(i.createAuthorizationFailedError())})}).catch(function(m){I(i.createAuthorizationFailedError())})})},i.createError=function(t,a){var u=new Error;return u.message=a,u.name=String(t),u},i.createAuthorizationFailedError=function(){return i.createError(l.StatusCode.AUTHORIZATION_FAILED,"Authorization failed")},i.createRestrictedError=function(){return i.createError(l.StatusCode.RESTRICTED,"Restricted")},i.createInternalServerError=function(t){return i.createError(l.StatusCode.INTERNAL_SERVER_ERROR,t)},i.authorize=function(t,a,u,f,g,_,v,E){return new Promise(function(y,d){t.getData().then(function(){t.isAccessControlled()?E(t,a).then(function(T){T?t.getData(T).then(function(){t.status===p.OK?y(t):i.showAuthInteraction(t,a,u,f,g,_,v,y,d)}).catch(function(I){d(i.createInternalServerError(I))}):_(t,!1).then(function(I){I?v(t,I,a).then(function(){t.getData(I).then(function(){t.status===p.OK?y(t):i.showAuthInteraction(t,a,u,f,g,_,v,y,d)}).catch(function(m){d(i.createInternalServerError(m))})}).catch(function(m){d(i.createInternalServerError(m))}):i.showAuthInteraction(t,a,u,f,g,_,v,y,d)})}).catch(function(T){d(i.createInternalServerError(T))}):y(t)})})},i.showAuthInteraction=function(t,a,u,f,g,_,v,E,y){t.status!==p.MOVED_TEMPORARILY||t.isResponseHandled?t.clickThroughService&&!t.isResponseHandled?u(t).then(function(){_(t,!0).then(function(d){v(t,d,a).then(function(){t.getData(d).then(function(){E(t)}).catch(function(T){y(i.createInternalServerError(T))})}).catch(function(T){y(i.createInternalServerError(T))})}).catch(function(d){y(i.createInternalServerError(d))})}):g(t).then(function(){_(t,!0).then(function(d){v(t,d,a).then(function(){t.getData(d).then(function(){E(t)}).catch(function(T){y(i.createInternalServerError(T))})}).catch(function(T){y(i.createInternalServerError(T))})}).catch(function(d){y(i.createInternalServerError(d))})}):E(t)},i.getService=function(t,a){for(var u=this.getServices(t),f=0;f<u.length;f++){var g=u[f];if(g.getProfile()===a)return g}return null},i.getResourceById=function(t,a){return i.traverseAndFind(t.__jsonld,"@id",a)},i.traverseAndFind=function(t,a,u){if(t.hasOwnProperty(a)&&t[a]===u)return t;for(var f=0;f<Object.keys(t).length;f++)if(typeof t[Object.keys(t)[f]]=="object"){var g=i.traverseAndFind(t[Object.keys(t)[f]],a,u);if(g!=null)return g}},i.getServices=function(t,a){var u=a===void 0?{}:a,f=u.onlyService,g=f!==void 0&&f,_=u.onlyServices,v=_!==void 0&&_,E=u.skipParentResources,y=[];!(E!==void 0&&E)&&t&&t.options&&t.options.resource&&t.options.resource!==t&&y.push.apply(y,i.getServices(t.options.resource,{onlyServices:!0}));var d=v?[]:(t.__jsonld||t).service||[];if(Array.isArray(d)||(d=[d]),g||d.push.apply(d,(t.__jsonld||t).services||[]),d.length===0)return y;for(var T=0;T<d.length;T++){var I=d[T];if(typeof I=="string"){var m=this.getResourceById(t.options.resource,I);m&&y.push(new l.Service(m.__jsonld||m,t.options))}else y.push(new l.Service(I,t.options))}return y},i.getTemporalComponent=function(t){var a=/t=([^&]+)/g.exec(t),u=null;return a&&a[1]&&(u=a[1].split(",")),u},i}();e.Utils=h},function(o,e,r){var n=r(19),c=r(20);o.exports=function l(s,p,h,i,t){var a=-1,u=s.length;for(h||(h=c),t||(t=[]);++a<u;){var f=s[a];p>0&&h(f)?p>1?l(f,p-1,h,i,t):n(t,f):i||(t[t.length]=f)}return t}},function(o,e){o.exports=function(r){return r!=null&&typeof r=="object"}},function(o,e,r){"use strict";r.r(e),e.default=function(n,c){return c=c||{},new Promise(function(l,s){var p=new XMLHttpRequest,h=[],i=[],t={},a=function(){return{ok:(p.status/100|0)==2,statusText:p.statusText,status:p.status,url:p.responseURL,text:function(){return Promise.resolve(p.responseText)},json:function(){return Promise.resolve(JSON.parse(p.responseText))},blob:function(){return Promise.resolve(new Blob([p.response]))},clone:a,headers:{keys:function(){return h},entries:function(){return i},get:function(f){return t[f.toLowerCase()]},has:function(f){return f.toLowerCase()in t}}}};for(var u in p.open(c.method||"get",n,!0),p.onload=function(){p.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(f,g,_){h.push(g=g.toLowerCase()),i.push([g,_]),t[g]=t[g]?t[g]+","+_:_}),l(a())},p.onerror=s,p.withCredentials=c.credentials=="include",c.headers)p.setRequestHeader(u,c.headers[u]);p.send(c.body||null)})}},function(o,e,r){o.exports=r(8)},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(c){for(var l in c)e.hasOwnProperty(l)||(e[l]=c[l])}(r(0));var n=r(3);e.loadManifest=function(c){return n.Utils.loadManifest(c)},e.parseManifest=function(c,l){return n.Utils.parseManifest(c,l)}},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function c(l){this.__jsonld=l,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return c.prototype.getProperty=function(l){var s=null;return this.__jsonld&&((s=this.__jsonld[l])||(s=this.__jsonld["@"+l])),s},c}();e.JSONLDResource=n},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(h,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])})(h,i)},function(h,i){function t(){this.constructor=h}n(h,i),h.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=r(1),p=function(h){function i(t,a){var u=h.call(this,t)||this;return u.options=a,u}return c(i,h),i.prototype.getIIIFResourceType=function(){return l.Utils.normaliseType(this.getProperty("type"))},i.prototype.getLabel=function(){var t=this.getProperty("label");return t?l.PropertyValue.parse(t,this.options.locale):new l.PropertyValue([],this.options.locale)},i.prototype.getDefaultLabel=function(){return this.getLabel().getValue(this.options.locale)},i.prototype.getMetadata=function(){var t=this.getProperty("metadata"),a=[];if(!t)return a;for(var u=0;u<t.length;u++){var f=t[u],g=new l.LabelValuePair(this.options.locale);g.parse(f),a.push(g)}return a},i.prototype.getRendering=function(t){for(var a=this.getRenderings(),u=0;u<a.length;u++){var f=a[u];if(f.getFormat()===t)return f}return null},i.prototype.getRenderings=function(){var t,a=[];if(!(t=this.__jsonld?this.__jsonld.rendering:this.rendering))return a;Array.isArray(t)||(t=[t]);for(var u=0;u<t.length;u++){var f=t[u];a.push(new l.Rendering(f,this.options))}return a},i.prototype.getRequiredStatement=function(){var t=null,a=this.getProperty("requiredStatement");return a&&(t=new l.LabelValuePair(this.options.locale)).parse(a),t},i.prototype.getService=function(t){return l.Utils.getService(this,t)},i.prototype.getServices=function(){return l.Utils.getServices(this)},i.prototype.getThumbnail=function(){var t=this.getProperty("thumbnail");return Array.isArray(t)&&(t=t[0]),t?new l.Thumbnail(t,this.options):null},i.prototype.isAnnotation=function(){return this.getIIIFResourceType()===s.IIIFResourceType.ANNOTATION},i.prototype.isCanvas=function(){return this.getIIIFResourceType()===s.IIIFResourceType.CANVAS},i.prototype.isCollection=function(){return this.getIIIFResourceType()===s.IIIFResourceType.COLLECTION},i.prototype.isManifest=function(){return this.getIIIFResourceType()===s.IIIFResourceType.MANIFEST},i.prototype.isRange=function(){return this.getIIIFResourceType()===s.IIIFResourceType.RANGE},i.prototype.isSequence=function(){return this.getIIIFResourceType()===s.IIIFResourceType.SEQUENCE},i}(l.JSONLDResource);e.ManifestResource=p},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(p,h){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var a in t)t.hasOwnProperty(a)&&(i[a]=t[a])})(p,h)},function(p,h){function i(){this.constructor=p}n(p,h),p.prototype=h===null?Object.create(h):(i.prototype=h.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=function(p){function h(i,t){return p.call(this,i,t)||this}return c(h,p),h.prototype.getFormat=function(){var i=this.getProperty("format");return i?i.toLowerCase():null},h.prototype.getResources=function(){var i=[];if(!this.__jsonld.resources)return i;for(var t=0;t<this.__jsonld.resources.length;t++){var a=this.__jsonld.resources[t],u=new l.Annotation(a,this.options);i.push(u)}return i},h.prototype.getType=function(){var i=this.getProperty("type");return i?l.Utils.normaliseType(i):null},h.prototype.getWidth=function(){return this.getProperty("width")},h.prototype.getHeight=function(){return this.getProperty("height")},h.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},h.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},h}(l.ManifestResource);e.Resource=s},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(h,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])})(h,i)},function(h,i){function t(){this.constructor=h}n(h,i),h.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=r(1),p=function(h){function i(t,a){var u=h.call(this,t,a)||this;u.index=-1,u.isLoaded=!1;var f={defaultLabel:"-",locale:"en-GB",resource:u,pessimisticAccessControl:!1};return u.options=Object.assign(f,a),u}return c(i,h),i.prototype.getAttribution=function(){var t=this.getProperty("attribution");return t?l.PropertyValue.parse(t,this.options.locale):new l.PropertyValue([],this.options.locale)},i.prototype.getDescription=function(){var t=this.getProperty("description");return t?l.PropertyValue.parse(t,this.options.locale):new l.PropertyValue([],this.options.locale)},i.prototype.getHomepage=function(){var t=this.getProperty("homepage");return t?typeof t=="string"?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},i.prototype.getIIIFResourceType=function(){return l.Utils.normaliseType(this.getProperty("type"))},i.prototype.getLogo=function(){var t=this.getProperty("logo");if(!t){var a=this.getProperty("provider");if(!a)return null;t=a.logo}return t?typeof t=="string"?t:(Array.isArray(t)&&t.length&&(t=t[0]),t["@id"]||t.id):null},i.prototype.getLicense=function(){return l.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},i.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},i.prototype.getRelated=function(){return this.getProperty("related")},i.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},i.prototype.getTrackingLabel=function(){var t=this.getService(s.ServiceProfile.TRACKING_EXTENSIONS);return t?t.getProperty("trackingLabel"):""},i.prototype.getDefaultTree=function(){return this.defaultTree=new l.TreeNode("root"),this.defaultTree.data=this,this.defaultTree},i.prototype.getRequiredStatement=function(){var t=null,a=this.getProperty("requiredStatement");if(a)(t=new l.LabelValuePair(this.options.locale)).parse(a);else{var u=this.getAttribution();u&&((t=new l.LabelValuePair(this.options.locale)).value=u)}return t},i.prototype.isCollection=function(){return this.getIIIFResourceType()===s.IIIFResourceType.COLLECTION},i.prototype.isManifest=function(){return this.getIIIFResourceType()===s.IIIFResourceType.MANIFEST},i.prototype.load=function(){var t=this;return new Promise(function(a){if(t.isLoaded)a(t);else{var u=t.options;u.navDate=t.getNavDate();var f=t.__jsonld.id;f||(f=t.__jsonld["@id"]),l.Utils.loadManifest(f).then(function(g){t.parentLabel=t.getLabel().getValue(u.locale);var _=l.Deserialiser.parse(g,u);(t=Object.assign(t,_)).index=u.index,a(t)})}})},i}(l.ManifestResource);e.IIIFResource=p},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(p,h){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var a in t)t.hasOwnProperty(a)&&(i[a]=t[a])})(p,h)},function(p,h){function i(){this.constructor=p}n(p,h),p.prototype=h===null?Object.create(h):(i.prototype=h.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=function(p){function h(i,t){return p.call(this,i,t)||this}return c(h,p),h.prototype.getBody=function(){var i=[],t=this.getProperty("body");if(t)if(Array.isArray(t))for(var a=0;a<t.length;a++)if((g=t[a]).items)for(var u=0;u<g.items.length;u++){var f=g.items[u];i.push(new l.AnnotationBody(f,this.options))}else i.push(new l.AnnotationBody(g,this.options));else if(t.items)for(a=0;a<t.items.length;a++){var g=t.items[a];i.push(new l.AnnotationBody(g,this.options))}else i.push(new l.AnnotationBody(t,this.options));return i},h.prototype.getMotivation=function(){var i=this.getProperty("motivation");return i||null},h.prototype.getOn=function(){return this.getProperty("on")},h.prototype.getTarget=function(){return this.getProperty("target")},h.prototype.getResource=function(){return new l.Resource(this.getProperty("resource"),this.options)},h}(l.ManifestResource);e.Annotation=s},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(p,h){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var a in t)t.hasOwnProperty(a)&&(i[a]=t[a])})(p,h)},function(p,h){function i(){this.constructor=p}n(p,h),p.prototype=h===null?Object.create(h):(i.prototype=h.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=function(p){function h(i,t){return p.call(this,i,t)||this}return c(h,p),h.prototype.getFormat=function(){var i=this.getProperty("format");return i?l.Utils.getMediaType(i):null},h.prototype.getType=function(){return this.getProperty("type")?l.Utils.normaliseType(this.getProperty("type")):null},h.prototype.getWidth=function(){return this.getProperty("width")},h.prototype.getHeight=function(){return this.getProperty("height")},h}(l.ManifestResource);e.AnnotationBody=s},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(p,h){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var a in t)t.hasOwnProperty(a)&&(i[a]=t[a])})(p,h)},function(p,h){function i(){this.constructor=p}n(p,h),p.prototype=h===null?Object.create(h):(i.prototype=h.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=function(p){function h(i,t,a){var u=p.call(this,t)||this;return u.label=i,u.options=a,u}return c(h,p),h.prototype.getIIIFResourceType=function(){return l.Utils.normaliseType(this.getProperty("type"))},h.prototype.getLabel=function(){return this.label},h.prototype.getResources=function(){var i=this;return this.getProperty("resources").map(function(t){return new l.Annotation(t,i.options)})},h.prototype.load=function(){var i=this;return new Promise(function(t,a){if(i.isLoaded)t(i);else{var u=i.__jsonld.id;u||(u=i.__jsonld["@id"]),l.Utils.loadManifest(u).then(function(f){i.__jsonld=f,i.context=i.getProperty("context"),i.id=i.getProperty("id"),i.isLoaded=!0,t(i)}).catch(a)}})},h}(l.JSONLDResource);e.AnnotationList=s},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(s,p){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,i){h.__proto__=i}||function(h,i){for(var t in i)i.hasOwnProperty(t)&&(h[t]=i[t])})(s,p)},function(s,p){function h(){this.constructor=s}n(s,p),s.prototype=p===null?Object.create(p):(h.prototype=p.prototype,new h)});Object.defineProperty(e,"__esModule",{value:!0});var l=function(s){function p(h,i){return s.call(this,h,i)||this}return c(p,s),p.prototype.getItems=function(){return this.getProperty("items")},p}(r(0).ManifestResource);e.AnnotationPage=l},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(a,u){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,g){f.__proto__=g}||function(f,g){for(var _ in g)g.hasOwnProperty(_)&&(f[_]=g[_])})(a,u)},function(a,u){function f(){this.constructor=a}n(a,u),a.prototype=u===null?Object.create(u):(f.prototype=u.prototype,new f)}),l=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0});var s=r(1),p=r(0),h=l(r(18)),i=l(r(30)),t=function(a){function u(f,g){return a.call(this,f,g)||this}return c(u,a),u.prototype.getCanonicalImageUri=function(f){var g,_=null,v="default",E=f;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])_=this.externalResource.data["@id"],E||(E=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(v="native");else{var y=void 0;if((y=this.getImages())&&y.length){var d=y[0].getResource(),T=d.getServices();if(E||(E=d.getWidth()),I=T?T.find(function(M){return p.Utils.isImageProfile(M.getProfile())||p.Utils.isImageServiceType(M.getIIIFResourceType())}):null)_=I.id,v=p.Utils.getImageQuality(I.getProfile());else if(E===d.getWidth())return d.id}if((y=this.getContent())&&y.length){var I,m=y[0].getBody()[0];if(T=m.getServices(),E||(E=m.getWidth()),I=T?T.find(function(M){return p.Utils.isImageServiceType(M.getIIIFResourceType())}):null)_=I.id,v=p.Utils.getImageQuality(I.getProfile());else if(E===m.getWidth())return m.id}if(!_){var A=this.getProperty("thumbnail");if(A){if(typeof A=="string")return A;if(A["@id"])return A["@id"];if(A.length)return A[0].id}}}return g=E+",",_&&_.endsWith("/")&&(_=_.substr(0,_.length-1)),[_,"full",g,0,v+".jpg"].join("/")},u.prototype.getMaxDimensions=function(){var f,g=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(f=this.externalResource.data.profile,Array.isArray(f)&&(f=f.filter(function(_){return _.maxWidth})[0])&&(g=new p.Size(f.maxWidth,f.maxHeight?f.maxHeight:f.maxWidth))),g},u.prototype.getContent=function(){var f=[],g=this.__jsonld.items||this.__jsonld.content;if(!g)return f;var _=null;if(g.length&&(_=new p.AnnotationPage(g[0],this.options)),!_)return f;for(var v=_.getItems(),E=0;E<v.length;E++){var y=v[E],d=new p.Annotation(y,this.options);f.push(d)}return f},u.prototype.getDuration=function(){return this.getProperty("duration")},u.prototype.getImages=function(){var f=[];if(!this.__jsonld.images)return f;for(var g=0;g<this.__jsonld.images.length;g++){var _=this.__jsonld.images[g],v=new p.Annotation(_,this.options);f.push(v)}return f},u.prototype.getIndex=function(){return this.getProperty("index")},u.prototype.getOtherContent=function(){var f=this,g=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],_=g.filter(function(v){return v&&(E=v["@type"],y="sc:AnnotationList",typeof E=="string"&&typeof y=="string"&&E.toLowerCase()==E.toLowerCase());var E,y}).map(function(v,E){return new p.AnnotationList(v.label||"Annotation list "+E,v,f.options)}).map(function(v){return v.load()});return Promise.all(_)},u.prototype.getWidth=function(){return this.getProperty("width")},u.prototype.getHeight=function(){return this.getProperty("height")},u.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},Object.defineProperty(u.prototype,"imageResources",{get:function(){var f=this,g=i.default([this.getImages().map(function(_){return _.getResource()}),this.getContent().map(function(_){return _.getBody()})]);return h.default(g.map(function(_){switch(_.getProperty("type").toLowerCase()){case s.ExternalResourceType.CHOICE:case s.ExternalResourceType.OA_CHOICE:return new u({images:h.default([_.getProperty("default"),_.getProperty("item")]).map(function(v){return{resource:v}})},f.options).getImages().map(function(v){return v.getResource()});default:return _}}))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"resourceAnnotations",{get:function(){return i.default([this.getImages(),this.getContent()])},enumerable:!0,configurable:!0}),u.prototype.resourceAnnotation=function(f){return this.resourceAnnotations.find(function(g){return g.getResource().id===f||h.default(new Array(g.getBody())).some(function(_){return _.id===f})})},u.prototype.onFragment=function(f){var g=this.resourceAnnotation(f);if(g){var _=g.getProperty("on"),v=g.getProperty("target"),E=(_||v).match(/xywh=(.*)$/);if(E)return E[1].split(",").map(function(y){return parseInt(y,10)})}},Object.defineProperty(u.prototype,"iiifImageResources",{get:function(){return this.imageResources.filter(function(f){return f&&f.getServices()[0]&&f.getServices()[0].id})},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"imageServiceIds",{get:function(){return this.iiifImageResources.map(function(f){return f.getServices()[0].id})},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"aspectRatio",{get:function(){return this.getWidth()/this.getHeight()},enumerable:!0,configurable:!0}),u}(p.Resource);e.Canvas=t},function(o,e,r){var n=r(4);o.exports=function(c){return(c==null?0:c.length)?n(c,1):[]}},function(o,e){o.exports=function(r,n){for(var c=-1,l=n.length,s=r.length;++c<l;)r[s+c]=n[c];return r}},function(o,e,r){var n=r(2),c=r(24),l=r(29),s=n?n.isConcatSpreadable:void 0;o.exports=function(p){return l(p)||c(p)||!!(s&&p&&p[s])}},function(o,e,r){var n=r(22),c=typeof self=="object"&&self&&self.Object===Object&&self,l=n||c||Function("return this")();o.exports=l},function(o,e,r){(function(n){var c=typeof n=="object"&&n&&n.Object===Object&&n;o.exports=c}).call(this,r(23))},function(o,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}o.exports=r},function(o,e,r){var n=r(25),c=r(5),l=Object.prototype,s=l.hasOwnProperty,p=l.propertyIsEnumerable,h=n(function(){return arguments}())?n:function(i){return c(i)&&s.call(i,"callee")&&!p.call(i,"callee")};o.exports=h},function(o,e,r){var n=r(26),c=r(5),l="[object Arguments]";o.exports=function(s){return c(s)&&n(s)==l}},function(o,e,r){var n=r(2),c=r(27),l=r(28),s="[object Null]",p="[object Undefined]",h=n?n.toStringTag:void 0;o.exports=function(i){return i==null?i===void 0?p:s:h&&h in Object(i)?c(i):l(i)}},function(o,e,r){var n=r(2),c=Object.prototype,l=c.hasOwnProperty,s=c.toString,p=n?n.toStringTag:void 0;o.exports=function(h){var i=l.call(h,p),t=h[p];try{h[p]=void 0;var a=!0}catch{}var u=s.call(h);return a&&(i?h[p]=t:delete h[p]),u}},function(o,e){var r=Object.prototype.toString;o.exports=function(n){return r.call(n)}},function(o,e){var r=Array.isArray;o.exports=r},function(o,e,r){var n=r(4),c=1/0;o.exports=function(l){return(l==null?0:l.length)?n(l,c):[]}},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(h,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])})(h,i)},function(h,i){function t(){this.constructor=h}n(h,i),h.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(1),s=r(0),p=function(h){function i(t,a){var u=h.call(this,t,a)||this;return u.items=[],u._collections=null,u._manifests=null,t.__collection=u,u}return c(i,h),i.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter(function(t){return t.isCollection()})},i.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter(function(t){return t.isManifest()})},i.prototype.getCollectionByIndex=function(t){for(var a,u=this.getCollections(),f=0;f<u.length;f++){var g=u[f];g.index===t&&(a=g)}if(a)return a.options.index=t,a.load();throw new Error("Collection index not found")},i.prototype.getManifestByIndex=function(t){for(var a,u=this.getManifests(),f=0;f<u.length;f++){var g=u[f];g.index===t&&(a=g)}if(a)return a.options.index=t,a.load();throw new Error("Manifest index not found")},i.prototype.getTotalCollections=function(){return this.getCollections().length},i.prototype.getTotalManifests=function(){return this.getManifests().length},i.prototype.getTotalItems=function(){return this.items.length},i.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):l.ViewingDirection.LEFT_TO_RIGHT},i.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},i.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},i.prototype.getDefaultTree=function(){return h.prototype.getDefaultTree.call(this),this.defaultTree.data.type=s.Utils.normaliseType(s.TreeNodeType.COLLECTION),this._parseManifests(this),this._parseCollections(this),s.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},i.prototype._parseManifests=function(t){if(t.getManifests()&&t.getManifests().length)for(var a=0;a<t.getManifests().length;a++){var u=t.getManifests()[a],f=u.getDefaultTree();f.label=u.parentLabel||u.getLabel().getValue(this.options.locale)||"manifest "+(a+1),f.navDate=u.getNavDate(),f.data.id=u.id,f.data.type=s.Utils.normaliseType(s.TreeNodeType.MANIFEST),t.defaultTree.addNode(f)}},i.prototype._parseCollections=function(t){if(t.getCollections()&&t.getCollections().length)for(var a=0;a<t.getCollections().length;a++){var u=t.getCollections()[a],f=u.getDefaultTree();f.label=u.parentLabel||u.getLabel().getValue(this.options.locale)||"collection "+(a+1),f.navDate=u.getNavDate(),f.data.id=u.id,f.data.type=s.Utils.normaliseType(s.TreeNodeType.COLLECTION),t.defaultTree.addNode(f)}},i}(s.IIIFResource);e.Collection=p},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function c(l,s){this.start=l,this.end=s}return c.prototype.getLength=function(){return this.end-this.start},c}();e.Duration=n},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),c=function(){function l(s){this.defaultLocale=s}return l.prototype.parse=function(s){this.resource=s,this.label=n.PropertyValue.parse(this.resource.label,this.defaultLocale),this.value=n.PropertyValue.parse(this.resource.value,this.defaultLocale)},l.prototype.getLabel=function(s){return this.label===null?null:(Array.isArray(s)&&!s.length&&(s=void 0),this.label.getValue(s||this.defaultLocale))},l.prototype.setLabel=function(s){this.label===null&&(this.label=new n.PropertyValue([])),this.label.setValue(s,this.defaultLocale)},l.prototype.getValue=function(s,p){return p===void 0&&(p="<br/>"),this.value===null?null:(Array.isArray(s)&&!s.length&&(s=void 0),this.value.getValue(s||this.defaultLocale,p))},l.prototype.getValues=function(s){return this.value===null?[]:(Array.isArray(s)&&!s.length&&(s=void 0),this.value.getValues(s||this.defaultLocale))},l.prototype.setValue=function(s){this.value===null&&(this.value=new n.PropertyValue([])),this.value.setValue(s,this.defaultLocale)},l}();e.LabelValuePair=c},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(s,p){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,i){h.__proto__=i}||function(h,i){for(var t in i)i.hasOwnProperty(t)&&(h[t]=i[t])})(s,p)},function(s,p){function h(){this.constructor=s}n(s,p),s.prototype=p===null?Object.create(p):(h.prototype=p.prototype,new h)});Object.defineProperty(e,"__esModule",{value:!0});var l=function(s){function p(){return s!==null&&s.apply(this,arguments)||this}return c(p,s),p.getValue=function(h,i){return h.getValue(i,"<br/>")},p.getValues=function(h,i){return h.getValues(i)},p}(Array);e.LanguageMap=l},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(i,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,u){a.__proto__=u}||function(a,u){for(var f in u)u.hasOwnProperty(f)&&(a[f]=u[f])})(i,t)},function(i,t){function a(){this.constructor=i}n(i,t),i.prototype=t===null?Object.create(t):(a.prototype=t.prototype,new a)}),l=this&&this.__spreadArrays||function(){for(var i=0,t=0,a=arguments.length;t<a;t++)i+=arguments[t].length;var u=Array(i),f=0;for(t=0;t<a;t++)for(var g=arguments[t],_=0,v=g.length;_<v;_++,f++)u[f]=g[_];return u};Object.defineProperty(e,"__esModule",{value:!0});var s=r(3),p=function(){function i(t,a,u){u===void 0&&(u="none"),Array.isArray(t)&&t.length===1?this._value=t[0]:this._value=t,a!=="none"&&a!=="@none"||(a=void 0),this._locale=a,this._defaultLocale=u}return i.parseV2Value=function(t,a){return typeof t=="string"?new i(t,void 0,a):t["@value"]?new i(t["@value"],t["@language"],a):null},Object.defineProperty(i.prototype,"value",{get:function(){return Array.isArray(this._value)?this._value.join("<br/>"):this._value},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"locale",{get:function(){return this._locale===void 0?this._defaultLocale:this._locale},enumerable:!0,configurable:!0}),i.prototype.addValue=function(t){Array.isArray(this._value)||(this._value=[this._value]),Array.isArray(t)?this._value=this._value.concat(t):this._value.push(t)},i}();e.LocalizedValue=p;var h=function(i){function t(a,u){a===void 0&&(a=[]);var f=i.apply(this,a)||this;return f.__proto__=t.prototype,f._defaultLocale=u,f}return c(t,i),t.parse=function(a,u){if(!a)return new t([],u);if(Array.isArray(a)){var f=(g=a.map(function(_){return p.parseV2Value(_,u)}).filter(function(_){return _!==null})).reduce(function(_,v){var E=v._locale;return E||(E="none"),_[E]?_[E].addValue(v._value):_[E]=v,_},{});return new t(Object.values(f),u)}return typeof a=="string"?new t([new p(a,void 0,u)],u):a["@language"]?new t((g=p.parseV2Value(a))!==null?[g]:[],u):a["@value"]?new t((g=p.parseV2Value(a))!==null?[g]:[],u):new t(Object.keys(a).map(function(_){var v=a[_];if(!Array.isArray(v))throw new Error("A IIIF v3 localized property value must have an array as the value for a given language.");return new p(v,_,u)}),u);var g},t.prototype.getSuitableLocale=function(a){for(var u=l(this).map(function(I){return I._locale}).filter(function(I){return I!==void 0}),f=function(I){var m=u.find(function(A){return A===I});if(m)return{value:m}},g=0,_=a;g<_.length;g++){var v=f(_[g]);if(typeof v=="object")return v.value}for(var E=function(I){var m=u.find(function(A){return s.Utils.getInexactLocale(A)===s.Utils.getInexactLocale(I)});if(m)return{value:m}},y=0,d=a;y<d.length;y++){var T=E(d[y]);if(typeof T=="object")return T.value}},t.prototype.setValue=function(a,u){var f=void 0;if(u){var g=this.getSuitableLocale([u]);g&&(f=this.find(function(_){return _._locale===g}))}else f=this.find(function(_){return _._locale===void 0});f?f._value=a:this.push(new p(a,u,this._defaultLocale))},t.prototype.getValue=function(a,u){var f=this.getValues(a);return f.length===0?null:u?f.join(u):f[0]},t.prototype.getValues=function(a){if(!this.length)return[];var u;if(u=a?Array.isArray(a)?a:[a]:[],this.length===1&&this[0]._locale===void 0){var f=this[0]._value;return Array.isArray(f)?f:[f]}var g=this.getSuitableLocale(u);if(g)return f=this.find(function(v){return v._locale===g})._value,Array.isArray(f)?f:[f];if(!this.find(function(v){return v._locale===void 0}))return f=this[0]._value,Array.isArray(f)?f:[f];var _=this.find(function(v){return v._locale===void 0});return _?Array.isArray(_._value)?_._value:[_._value]:[]},t}(Array);e.PropertyValue=h},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONTINUE=100,e.SWITCHING_PROTOCOLS=101,e.PROCESSING=102,e.OK=200,e.CREATED=201,e.ACCEPTED=202,e.NON_AUTHORITATIVE_INFORMATION=203,e.NO_CONTENT=204,e.RESET_CONTENT=205,e.PARTIAL_CONTENT=206,e.MULTI_STATUS=207,e.MULTIPLE_CHOICES=300,e.MOVED_PERMANENTLY=301,e.MOVED_TEMPORARILY=302,e.SEE_OTHER=303,e.NOT_MODIFIED=304,e.USE_PROXY=305,e.TEMPORARY_REDIRECT=307,e.BAD_REQUEST=400,e.UNAUTHORIZED=401,e.PAYMENT_REQUIRED=402,e.FORBIDDEN=403,e.NOT_FOUND=404,e.METHOD_NOT_ALLOWED=405,e.NOT_ACCEPTABLE=406,e.PROXY_AUTHENTICATION_REQUIRED=407,e.REQUEST_TIME_OUT=408,e.CONFLICT=409,e.GONE=410,e.LENGTH_REQUIRED=411,e.PRECONDITION_FAILED=412,e.REQUEST_ENTITY_TOO_LARGE=413,e.REQUEST_URI_TOO_LARGE=414,e.UNSUPPORTED_MEDIA_TYPE=415,e.REQUESTED_RANGE_NOT_SATISFIABLE=416,e.EXPECTATION_FAILED=417,e.IM_A_TEAPOT=418,e.UNPROCESSABLE_ENTITY=422,e.LOCKED=423,e.FAILED_DEPENDENCY=424,e.UNORDERED_COLLECTION=425,e.UPGRADE_REQUIRED=426,e.PRECONDITION_REQUIRED=428,e.TOO_MANY_REQUESTS=429,e.REQUEST_HEADER_FIELDS_TOO_LARGE=431,e.INTERNAL_SERVER_ERROR=500,e.NOT_IMPLEMENTED=501,e.BAD_GATEWAY=502,e.SERVICE_UNAVAILABLE=503,e.GATEWAY_TIME_OUT=504,e.HTTP_VERSION_NOT_SUPPORTED=505,e.VARIANT_ALSO_NEGOTIATES=506,e.INSUFFICIENT_STORAGE=507,e.BANDWIDTH_LIMIT_EXCEEDED=509,e.NOT_EXTENDED=510,e.NETWORK_AUTHENTICATION_REQUIRED=511},function(o,e,r){o.exports=window.fetch||(window.fetch=r(6).default||r(6))},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(h,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])})(h,i)},function(h,i){function t(){this.constructor=h}n(h,i),h.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(1),s=r(0),p=function(h){function i(t,a){var u=h.call(this,t,a)||this;if(u.index=0,u._allRanges=null,u.items=[],u._topRanges=[],u.__jsonld.structures&&u.__jsonld.structures.length)for(var f=u._getTopRanges(),g=0;g<f.length;g++){var _=f[g];u._parseRanges(_,String(g))}return u}return c(i,h),i.prototype.getPosterCanvas=function(){var t=this.getProperty("posterCanvas");return t&&(t=new s.Canvas(t,this.options)),t},i.prototype.getAccompanyingCanvas=function(){var t=this.getProperty("accompanyingCanvas");return t&&(t=new s.Canvas(t,this.options)),t},i.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},i.prototype.getDefaultTree=function(){if(h.prototype.getDefaultTree.call(this),this.defaultTree.data.type=s.Utils.normaliseType(s.TreeNodeType.MANIFEST),!this.isLoaded)return this.defaultTree;var t=this.getTopRanges();return t.length&&t[0].getTree(this.defaultTree),s.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},i.prototype._getTopRanges=function(){var t=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var a=0;a<this.__jsonld.structures.length;a++){var u=this.__jsonld.structures[a];u.viewingHint===l.ViewingHint.TOP&&t.push(u)}if(!t.length){var f={};f.ranges=this.__jsonld.structures,t.push(f)}}return t},i.prototype.getTopRanges=function(){return this._topRanges},i.prototype._getRangeById=function(t){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var a=0;a<this.__jsonld.structures.length;a++){var u=this.__jsonld.structures[a];if(u["@id"]===t||u.id===t)return u}return null},i.prototype._parseRanges=function(t,a,u){var f,g=null;if(typeof t=="string"&&(g=t,t=this._getRangeById(g)),t){(f=new s.Range(t,this.options)).parentRange=u,f.path=a,u?u.items.push(f):this._topRanges.push(f);var _=t.items||t.members;if(_)for(var v=0;v<_.length;v++){var E=_[v];if(E["@type"]&&E["@type"].toLowerCase()==="sc:range"||E.type&&E.type.toLowerCase()==="range")this._parseRanges(E,a+"/"+v,f);else if(E["@type"]&&E["@type"].toLowerCase()==="sc:canvas"||E.type&&E.type.toLowerCase()==="canvas"){f.canvases||(f.canvases=[]);var y=E.id||E["@id"];f.canvases.push(y)}}else if(t.ranges)for(v=0;v<t.ranges.length;v++)this._parseRanges(t.ranges[v],a+"/"+v,f)}else console.warn("Range:",g,"does not exist")},i.prototype.getAllRanges=function(){if(this._allRanges!=null)return this._allRanges;this._allRanges=[];for(var t=this.getTopRanges(),a=function(g){var _=t[g];_.id&&u._allRanges.push(_);var v=function(y,d){y.add(d);var T=d.getRanges();return T.length?T.reduce(v,y):y},E=Array.from(_.getRanges().reduce(v,new Set));u._allRanges=u._allRanges.concat(E)},u=this,f=0;f<t.length;f++)a(f);return this._allRanges},i.prototype.getRangeById=function(t){for(var a=this.getAllRanges(),u=0;u<a.length;u++){var f=a[u];if(f.id===t)return f}return null},i.prototype.getRangeByPath=function(t){for(var a=this.getAllRanges(),u=0;u<a.length;u++){var f=a[u];if(f.path===t)return f}return null},i.prototype.getSequences=function(){if(this.items.length)return this.items;var t=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(t)for(var a=0;a<t.length;a++){var u=t[a],f=new s.Sequence(u,this.options);this.items.push(f)}else this.__jsonld.items&&(f=new s.Sequence(this.__jsonld.items,this.options),this.items.push(f));return this.items},i.prototype.getSequenceByIndex=function(t){return this.getSequences()[t]},i.prototype.getTotalSequences=function(){return this.getSequences().length},i.prototype.getManifestType=function(){var t=this.getService(l.ServiceProfile.UI_EXTENSIONS);return t?t.getProperty("manifestType"):s.ManifestType.EMPTY},i.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},i.prototype.isPagingEnabled=function(){var t=this.getViewingHint();if(t)return t===l.ViewingHint.PAGED;var a=this.getBehavior();return!!a&&a===l.Behavior.PAGED},i.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},i.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},i}(s.IIIFResource);e.Manifest=p},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(n){n.EMPTY="",n.MANUSCRIPT="manuscript",n.MONOGRAPH="monograph"}(e.ManifestType||(e.ManifestType={}))},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(h,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])})(h,i)},function(h,i){function t(){this.constructor=h}n(h,i),h.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=r(1),p=function(h){function i(t,a){var u=h.call(this,t,a)||this;return u._ranges=null,u.canvases=null,u.items=[],u}return c(i,h),i.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},i.prototype.getDuration=function(){if(this.canvases&&this.canvases.length){for(var t=[],a=[],u=0,f=this.canvases;u<f.length;u++)if(A=f[u]){var g=A.match(/(.*)#t=([0-9.]+),?([0-9.]+)?/)||[void 0,A],_=g[1],v=g[2],E=g[3];_&&(t.push(parseFloat(v)),a.push(parseFloat(E)))}if(t.length&&a.length)return new l.Duration(Math.min.apply(Math,t),Math.max.apply(Math,a))}else{t=[],a=[];for(var y=0,d=R=this.getRanges();y<d.length;y++)(U=d[y].getDuration())&&(t.push(U.start),a.push(U.end));if(t.length&&a.length)return new l.Duration(Math.min.apply(Math,t),Math.max.apply(Math,a))}var T,I;if(this.canvases&&this.canvases.length)for(var m=0;m<this.canvases.length;m++){var A=this.canvases[m],M=l.Utils.getTemporalComponent(A);M&&M.length>1&&(m===0&&(T=Number(M[0])),m===this.canvases.length-1&&(I=Number(M[1])))}else{var R=this.getRanges();for(m=0;m<R.length;m++){var U;(U=R[m].getDuration())&&(m===0&&(T=U.start),m===R.length-1&&(I=U.end))}}if(T!==void 0&&I!==void 0)return new l.Duration(T,I)},i.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter(function(t){return t.isRange()})},i.prototype.getBehavior=function(){var t=this.getProperty("behavior");return Array.isArray(t)&&(t=t[0]),t||null},i.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},i.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},i.prototype.getTree=function(t){t.data=this,this.treeNode=t;var a=this.getRanges();if(a&&a.length)for(var u=0;u<a.length;u++){var f=a[u],g=new l.TreeNode;t.addNode(g),this._parseTreeNode(g,f)}return l.Utils.generateTreeNodeIds(t),t},i.prototype.spansTime=function(t){var a=this.getDuration();return!!(a&&t>=a.start&&t<=a.end)},i.prototype._parseTreeNode=function(t,a){t.label=a.getLabel().getValue(this.options.locale),t.data=a,t.data.type=l.Utils.normaliseType(l.TreeNodeType.RANGE),a.treeNode=t;var u=a.getRanges();if(u&&u.length)for(var f=0;f<u.length;f++){var g=u[f];if(g.getBehavior()!==s.Behavior.NO_NAV){var _=new l.TreeNode;t.addNode(_),this._parseTreeNode(_,g)}}},i}(l.ManifestResource);e.Range=p},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(s,p){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,i){h.__proto__=i}||function(h,i){for(var t in i)i.hasOwnProperty(t)&&(h[t]=i[t])})(s,p)},function(s,p){function h(){this.constructor=s}n(s,p),s.prototype=p===null?Object.create(p):(h.prototype=p.prototype,new h)});Object.defineProperty(e,"__esModule",{value:!0});var l=function(s){function p(h,i){return s.call(this,h,i)||this}return c(p,s),p.prototype.getFormat=function(){return this.getProperty("format")},p}(r(0).ManifestResource);e.Rendering=l},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(h,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var u in a)a.hasOwnProperty(u)&&(t[u]=a[u])})(h,i)},function(h,i){function t(){this.constructor=h}n(h,i),h.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(1),s=r(0),p=function(h){function i(t,a){var u=h.call(this,t,a)||this;return u.items=[],u._thumbnails=null,u}return c(i,h),i.prototype.getCanvases=function(){if(this.items.length)return this.items;var t=this.__jsonld.canvases||this.__jsonld.elements;if(t)for(var a=0;a<t.length;a++){var u=t[a];(f=new s.Canvas(u,this.options)).index=a,this.items.push(f)}else if(this.__jsonld)for(a=0;a<this.__jsonld.length;a++){var f;u=this.__jsonld[a],(f=new s.Canvas(u,this.options)).index=a,this.items.push(f)}return this.items},i.prototype.getCanvasById=function(t){for(var a=0;a<this.getTotalCanvases();a++){var u=this.getCanvasByIndex(a),f=s.Utils.normaliseUrl(u.id);if(s.Utils.normaliseUrl(t)===f)return u}return null},i.prototype.getCanvasByIndex=function(t){return this.getCanvases()[t]},i.prototype.getCanvasIndexById=function(t){for(var a=0;a<this.getTotalCanvases();a++)if(this.getCanvasByIndex(a).id===t)return a;return null},i.prototype.getCanvasIndexByLabel=function(t,a){t=t.trim(),isNaN(t)||(t=parseInt(t,10).toString(),a&&(t+="r"));for(var u,f,g,_=/(\d*)\D+(\d*)/,v=0;v<this.getTotalCanvases();v++){var E=this.getCanvasByIndex(v);if(E.getLabel().getValue(this.options.locale)===t||(u=_.exec(t))&&(f=u[1],(g=u[2])&&new RegExp("^"+f+"\\D+"+g+"$").test(E.getLabel().toString())))return v}return-1},i.prototype.getLastCanvasLabel=function(t){for(var a=this.getTotalCanvases()-1;a>=0;a--){var u=this.getCanvasByIndex(a).getLabel().getValue(this.options.locale);if(t){if(/^[a-zA-Z0-9]*$/.test(u))return u}else if(u)return u}return this.options.defaultLabel},i.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},i.prototype.getNextPageIndex=function(t,a){var u;if(a){var f=this.getPagedIndices(t),g=this.getViewingDirection();u=g&&g===l.ViewingDirection.RIGHT_TO_LEFT?f[0]+1:f[f.length-1]+1}else u=t+1;return u>this.getLastPageIndex()?-1:u},i.prototype.getPagedIndices=function(t,a){var u=[];if(a){u=this.isFirstCanvas(t)||this.isLastCanvas(t)?[t]:t%2?[t,t+1]:[t-1,t];var f=this.getViewingDirection();f&&f===l.ViewingDirection.RIGHT_TO_LEFT&&(u=u.reverse())}else u.push(t);return u},i.prototype.getPrevPageIndex=function(t,a){var u;if(a){var f=this.getPagedIndices(t),g=this.getViewingDirection();u=g&&g===l.ViewingDirection.RIGHT_TO_LEFT?f[f.length-1]-1:f[0]-1}else u=t-1;return u},i.prototype.getStartCanvasIndex=function(){var t=this.getStartCanvas();if(t){for(var a=0;a<this.getTotalCanvases();a++)if(this.getCanvasByIndex(a).id===t)return a}return 0},i.prototype.getThumbs=function(t,a){for(var u=[],f=this.getTotalCanvases(),g=0;g<f;g++){var _=this.getCanvasByIndex(g),v=new s.Thumb(t,_);u.push(v)}return u},i.prototype.getThumbnails=function(){if(this._thumbnails!=null)return this._thumbnails;this._thumbnails=[];for(var t=this.getCanvases(),a=0;a<t.length;a++){var u=t[a].getThumbnail();u&&this._thumbnails.push(u)}return this._thumbnails},i.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},i.prototype.getTotalCanvases=function(){return this.getCanvases().length},i.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},i.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},i.prototype.isCanvasIndexOutOfRange=function(t){return t>this.getTotalCanvases()-1},i.prototype.isFirstCanvas=function(t){return t===0},i.prototype.isLastCanvas=function(t){return t===this.getTotalCanvases()-1},i.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},i.prototype.isPagingEnabled=function(){var t=this.getViewingHint();return!!t&&t===l.ViewingHint.PAGED},i.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},i}(s.ManifestResource);e.Sequence=p},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),c=function(){function l(){}return l.parse=function(s,p){return typeof s=="string"&&(s=JSON.parse(s)),this.parseJson(s,p)},l.parseJson=function(s,p){var h;if(p&&p.navDate&&!isNaN(p.navDate.getTime())&&(s.navDate=p.navDate.toString()),s["@type"])switch(s["@type"]){case"sc:Collection":h=this.parseCollection(s,p);break;case"sc:Manifest":h=this.parseManifest(s,p);break;default:return null}else switch(s.type){case"Collection":h=this.parseCollection(s,p);break;case"Manifest":h=this.parseManifest(s,p);break;default:return null}return h.isLoaded=!0,h},l.parseCollection=function(s,p){var h=new n.Collection(s,p);return p?(h.index=p.index||0,p.resource&&(h.parentCollection=p.resource.parentCollection)):h.index=0,this.parseCollections(h,p),this.parseManifests(h,p),this.parseItems(h,p),h},l.parseCollections=function(s,p){var h;if(s.__jsonld.collections?h=s.__jsonld.collections:s.__jsonld.items&&(h=s.__jsonld.items.filter(function(a){return a.type.toLowerCase()==="collection"})),h)for(var i=0;i<h.length;i++){p&&(p.index=i);var t=this.parseCollection(h[i],p);t.index=i,t.parentCollection=s,s.items.push(t)}},l.parseManifest=function(s,p){return new n.Manifest(s,p)},l.parseManifests=function(s,p){var h;if(s.__jsonld.manifests?h=s.__jsonld.manifests:s.__jsonld.items&&(h=s.__jsonld.items.filter(function(a){return a.type.toLowerCase()==="manifest"})),h)for(var i=0;i<h.length;i++){var t=this.parseManifest(h[i],p);t.index=i,t.parentCollection=s,s.items.push(t)}},l.parseItem=function(s,p){if(s["@type"]){if(s["@type"].toLowerCase()==="sc:manifest")return this.parseManifest(s,p);if(s["@type"].toLowerCase()==="sc:collection")return this.parseCollection(s,p)}else if(s.type){if(s.type.toLowerCase()==="manifest")return this.parseManifest(s,p);if(s.type.toLowerCase()==="collection")return this.parseCollection(s,p)}return null},l.parseItems=function(s,p){var h=s.__jsonld.members||s.__jsonld.items;if(h)for(var i=function(f){p&&(p.index=f);var g=t.parseItem(h[f],p);return g?s.items.filter(function(_){return _.id===g.id})[0]?"continue":(g.index=f,g.parentCollection=s,void s.items.push(g)):{value:void 0}},t=this,a=0;a<h.length;a++){var u=i(a);if(typeof u=="object")return u.value}},l}();e.Deserialiser=c},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(p,h){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var a in t)t.hasOwnProperty(a)&&(i[a]=t[a])})(p,h)},function(p,h){function i(){this.constructor=p}n(p,h),p.prototype=h===null?Object.create(h):(i.prototype=h.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var l=r(0),s=function(p){function h(i,t){return p.call(this,i,t)||this}return c(h,p),h.prototype.getProfile=function(){var i=this.getProperty("profile");return i||(i=this.getProperty("dcterms:conformsTo")),Array.isArray(i)?i[0]:i},h.prototype.getConfirmLabel=function(){return l.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},h.prototype.getDescription=function(){return l.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},h.prototype.getFailureDescription=function(){return l.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},h.prototype.getFailureHeader=function(){return l.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},h.prototype.getHeader=function(){return l.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},h.prototype.getServiceLabel=function(){return l.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},h.prototype.getInfoUri=function(){var i=this.id;return i.endsWith("/")||(i+="/"),i+="info.json"},h}(l.ManifestResource);e.Service=s},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(c,l){this.width=c,this.height=l};e.Size=n},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(n){n[n.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",n[n.FORBIDDEN=2]="FORBIDDEN",n[n.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",n[n.RESTRICTED=4]="RESTRICTED"}(e.StatusCode||(e.StatusCode={}))},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(c,l){this.data=l,this.index=l.index,this.width=c;var s=l.getHeight()/l.getWidth();this.height=s?Math.floor(this.width*s):c,this.uri=l.getCanonicalImageUri(c),this.label=l.getLabel().getValue(),this.viewingHint=l.getViewingHint()};e.Thumb=n},function(o,e,r){"use strict";var n,c=this&&this.__extends||(n=function(s,p){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,i){h.__proto__=i}||function(h,i){for(var t in i)i.hasOwnProperty(t)&&(h[t]=i[t])})(s,p)},function(s,p){function h(){this.constructor=s}n(s,p),s.prototype=p===null?Object.create(p):(h.prototype=p.prototype,new h)});Object.defineProperty(e,"__esModule",{value:!0});var l=function(s){function p(h,i){return s.call(this,h,i)||this}return c(p,s),p}(r(0).Resource);e.Thumbnail=l},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),c=function(){function l(s,p){this.label=s,this.data=p||{},this.nodes=[]}return l.prototype.addNode=function(s){this.nodes.push(s),s.parentNode=this},l.prototype.isCollection=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.COLLECTION)},l.prototype.isManifest=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.MANIFEST)},l.prototype.isRange=function(){return this.data.type===n.Utils.normaliseType(n.TreeNodeType.RANGE)},l}();e.TreeNode=c},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(n){n.COLLECTION="collection",n.MANIFEST="manifest",n.RANGE="range"}(e.TreeNodeType||(e.TreeNodeType={}))}])})});var $=k((B,W)=>{(function(o,e){typeof B=="object"&&typeof W=="object"?W.exports=e():typeof define=="function"&&define.amd?define("httpstatuscodes",[],e):typeof B=="object"?B.httpstatuscodes=e():o.httpstatuscodes=e()})(window,function(){return function(o){var e={};function r(n){if(e[n])return e[n].exports;var c=e[n]={i:n,l:!1,exports:{}};return o[n].call(c.exports,c,c.exports,r),c.l=!0,c.exports}return r.m=o,r.c=e,r.d=function(n,c,l){r.o(n,c)||Object.defineProperty(n,c,{enumerable:!0,get:l})},r.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,c){if(1&c&&(n=r(n)),8&c||4&c&&typeof n=="object"&&n&&n.__esModule)return n;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:n}),2&c&&typeof n!="string")for(var s in n)r.d(l,s,function(p){return n[p]}.bind(null,s));return l},r.n=function(n){var c=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(c,"a",c),c},r.o=function(n,c){return Object.prototype.hasOwnProperty.call(n,c)},r.p="",r(r.s=0)}([function(o,e,r){o.exports=r(1)},function(o,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONTINUE=100,e.SWITCHING_PROTOCOLS=101,e.PROCESSING=102,e.OK=200,e.CREATED=201,e.ACCEPTED=202,e.NON_AUTHORITATIVE_INFORMATION=203,e.NO_CONTENT=204,e.RESET_CONTENT=205,e.PARTIAL_CONTENT=206,e.MULTI_STATUS=207,e.MULTIPLE_CHOICES=300,e.MOVED_PERMANENTLY=301,e.MOVED_TEMPORARILY=302,e.SEE_OTHER=303,e.NOT_MODIFIED=304,e.USE_PROXY=305,e.TEMPORARY_REDIRECT=307,e.BAD_REQUEST=400,e.UNAUTHORIZED=401,e.PAYMENT_REQUIRED=402,e.FORBIDDEN=403,e.NOT_FOUND=404,e.METHOD_NOT_ALLOWED=405,e.NOT_ACCEPTABLE=406,e.PROXY_AUTHENTICATION_REQUIRED=407,e.REQUEST_TIME_OUT=408,e.CONFLICT=409,e.GONE=410,e.LENGTH_REQUIRED=411,e.PRECONDITION_FAILED=412,e.REQUEST_ENTITY_TOO_LARGE=413,e.REQUEST_URI_TOO_LARGE=414,e.UNSUPPORTED_MEDIA_TYPE=415,e.REQUESTED_RANGE_NOT_SATISFIABLE=416,e.EXPECTATION_FAILED=417,e.IM_A_TEAPOT=418,e.UNPROCESSABLE_ENTITY=422,e.LOCKED=423,e.FAILED_DEPENDENCY=424,e.UNORDERED_COLLECTION=425,e.UPGRADE_REQUIRED=426,e.PRECONDITION_REQUIRED=428,e.TOO_MANY_REQUESTS=429,e.REQUEST_HEADER_FIELDS_TOO_LARGE=431,e.INTERNAL_SERVER_ERROR=500,e.NOT_IMPLEMENTED=501,e.BAD_GATEWAY=502,e.SERVICE_UNAVAILABLE=503,e.GATEWAY_TIME_OUT=504,e.HTTP_VERSION_NOT_SUPPORTED=505,e.VARIANT_ALSO_NEGOTIATES=506,e.INSUFFICIENT_STORAGE=507,e.BANDWIDTH_LIMIT_EXCEEDED=509,e.NOT_EXTENDED=510,e.NETWORK_AUTHENTICATION_REQUIRED=511}])})});var X=function(){function o(e){this.isVisible=!0;var r=e.target.match(/.*[^n]xyz=(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?)/),n=e.target.match(/.*nxyz=(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?)/);this.bodyValue=e.bodyValue,this.x=Number(r[1]),this.y=Number(r[2]),this.z=Number(r[3]),this.nx=Number(n[1]),this.ny=Number(n[2]),this.nz=Number(n[3])}return o}();var Q=function(){function o(e){this.isVisible=!0;var r;e.on?(r=e.on.match(/.*xywh=(\d*),(\d*),(\d*),(\d*)/),this.chars=e.resource.chars):(r=e.target.match(/.*xywh=(\d*),(\d*),(\d*),(\d*)/),this.chars=e.bodyValue),this.x=Number(r[1]),this.y=Number(r[2]),this.width=Number(r[3]),this.height=Number(r[4])}return o}();var _t=function(){function o(e){this.rects=[],this.points3D=[],this.canvasId=e}return o.prototype.addRect=function(e){var r=new Q(e);r.canvasId=this.canvasId,r.canvasIndex=this.canvasIndex,r.index=this.rects.length,this.rects.push(r),this.rects.sort(function(n,c){return n.index-c.index})},o.prototype.addPoint3D=function(e){var r=new X(e);r.canvasId=this.canvasId,r.canvasIndex=this.canvasIndex,r.index=this.points3D.length,this.points3D.push(r),this.points3D.sort(function(n,c){return n.index-c.index})},o}();var Y=b(G()),z=function(){function o(){this.isEnabled=!1,this.ranges=[],this.canvases=[]}return o.prototype.allCanvasesSelected=function(){return this.canvases.length>0&&this.getAllSelectedCanvases().length===this.canvases.length},o.prototype.allRangesSelected=function(){return this.ranges.length>0&&this.getAllSelectedRanges().length===this.ranges.length},o.prototype.allSelected=function(){return this.allRangesSelected()&&this.allCanvasesSelected()},o.prototype.getAll=function(){return this.canvases.concat(this.ranges)},o.prototype.getAllSelectedCanvases=function(){return this.canvases.filter(function(e){return e.multiSelected})},o.prototype.getAllSelectedRanges=function(){return this.ranges.filter(function(e){return e.multiSelected})},o.prototype.getCanvasById=function(e){return this.canvases.filter(function(r){return Y.Utils.normaliseUrl(r.id)===Y.Utils.normaliseUrl(e)})[0]},o.prototype.getCanvasesByIds=function(e){for(var r=[],n=0;n<e.length;n++){var c=e[n];r.push(this.getCanvasById(c))}return r},o.prototype.getRangeCanvases=function(e){var r=e.getCanvasIds();return this.getCanvasesByIds(r)},o.prototype.selectAll=function(e){this.selectRanges(this.ranges,e),this.selectCanvases(this.canvases,e)},o.prototype.selectCanvas=function(e,r){var n=this.canvases.filter(function(c){return c.id===e.id})[0];n.multiSelected=r},o.prototype.selectAllCanvases=function(e){this.selectCanvases(this.canvases,e)},o.prototype.selectCanvases=function(e,r){for(var n=0;n<e.length;n++){var c=e[n];c.multiSelected=r}},o.prototype.selectRange=function(e,r){var n=this.ranges.filter(function(l){return l.id===e.id})[0];n.multiSelected=r;var c=this.getRangeCanvases(n);this.selectCanvases(c,r)},o.prototype.selectAllRanges=function(e){this.selectRanges(this.ranges,e)},o.prototype.selectRanges=function(e,r){for(var n=0;n<e.length;n++){var c=e[n];c.multiSelected=r;var l=this.getCanvasesByIds(c.getCanvasIds());this.selectCanvases(l,r)}},o.prototype.setEnabled=function(e){this.isEnabled=e;for(var r=this.getAll(),n=0;n<r.length;n++){var c=r[n];c.multiSelectEnabled=this.isEnabled,e||(c.multiSelected=!1)}},o}();var V=function(){function o(e,r){this.items=[],this.resource=e,this.label=r}return o.prototype.addItem=function(e){this.items.push(e)},o.prototype.addMetadata=function(e,r){r===void 0&&(r=!1);for(var n=0;n<e.length;n++){var c=e[n];c.isRootLevel=r,this.addItem(c)}},o}();var j;(function(o){o.DATE="date",o.NONE="none"})(j||(j={}));var N=b(H());var L=function(){function o(){}return o.manifestNotLoaded="Manifest has not loaded yet",o}();var S=b(G()),w=function(){return w=Object.assign||function(o){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&(o[c]=e[c])}return o},w.apply(this,arguments)},F=function(){function o(e){if(this.options=e,this.iiifResource=this.options.iiifResource,this.manifestUri=this.options.manifestUri,this.manifest=this.options.manifest,this.collectionIndex=this.options.collectionIndex||0,this.manifestIndex=this.options.manifestIndex||0,this.sequenceIndex=this.options.sequenceIndex||0,this.canvasIndex=this.options.canvasIndex||0,this.options.canvasId){var r=this.getCanvasIndexById(this.options.canvasId);r!==null&&(this.canvasIndex=r)}}return o.prototype.getAutoCompleteService=function(){var e=this.getSearchService(),r=null;return e&&(r=e.getService(N.ServiceProfile.SEARCH_0_AUTO_COMPLETE),r||(r=e.getService(N.ServiceProfile.SEARCH_1_AUTO_COMPLETE))),r},o.prototype.getAttribution=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.manifest.getAttribution();return e?e.getValue(this.options.locale):null},o.prototype.getCanvases=function(){return this.getCurrentSequence().getCanvases()},o.prototype.getCanvasById=function(e){return this.getCurrentSequence().getCanvasById(e)},o.prototype.getCanvasesById=function(e){for(var r=[],n=0;n<e.length;n++){var c=e[n],l=this.getCanvasById(c);l&&r.push(l)}return r},o.prototype.getCanvasByIndex=function(e){return this.getCurrentSequence().getCanvasByIndex(e)},o.prototype.getCanvasIndexById=function(e){return this.getCurrentSequence().getCanvasIndexById(e)},o.prototype.getCanvasIndexByLabel=function(e){var r=this.getManifestType()===S.ManifestType.MANUSCRIPT;return this.getCurrentSequence().getCanvasIndexByLabel(e,r)},o.prototype.getCanvasRange=function(e,r){var n=this.getCanvasRanges(e);if(r){for(var c=0;c<n.length;c++){var l=n[c];if(l.path===r)return l}return null}else return n[0]},o.prototype.getCanvasRanges=function(e){if(!this.manifest)throw new Error(L.manifestNotLoaded);return e.ranges||(e.ranges=this.manifest.getAllRanges().filter(function(r){return r.getCanvasIds().some(function(n){return S.Utils.normaliseUrl(n)===S.Utils.normaliseUrl(e.id)})})),e.ranges},o.prototype.getCollectionIndex=function(e){if(!(e.parentCollection&&!e.parentCollection.parentCollection)&&e.parentCollection)return e.parentCollection.index},o.prototype.getCurrentCanvas=function(){return this.getCurrentSequence().getCanvasByIndex(this.canvasIndex)},o.prototype.getCurrentSequence=function(){return this.getSequenceByIndex(this.sequenceIndex)},o.prototype.getDescription=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.manifest.getDescription();return e?e.getValue(this.options.locale):null},o.prototype.getLabel=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.manifest.getLabel();return e?e.getValue(this.options.locale):null},o.prototype.getLastCanvasLabel=function(e){return this.getCurrentSequence().getLastCanvasLabel(e)},o.prototype.getFirstPageIndex=function(){return 0},o.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},o.prototype.getLicense=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getLicense()},o.prototype.getLogo=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getLogo()},o.prototype.getManifestType=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.manifest.getManifestType();return e===S.ManifestType.EMPTY&&(e=S.ManifestType.MONOGRAPH),e},o.prototype.getMetadata=function(e){if(!this.manifest)throw new Error(L.manifestNotLoaded);var r=[],n=this.manifest.getMetadata(),c=new V(this.manifest),l=this.options.locale;if(n&&n.length&&c.addMetadata(n,!0),this.manifest.getDescription().length){var s=new S.LabelValuePair(l);s.label=new S.PropertyValue([new S.LocalizedValue("description",l)]),s.value=this.manifest.getDescription(),s.isRootLevel=!0,c.addItem(s)}if(this.manifest.getAttribution().length){var s=new S.LabelValuePair(l);s.label=new S.PropertyValue([new S.LocalizedValue("attribution",l)]),s.value=this.manifest.getAttribution(),s.isRootLevel=!0,c.addItem(s)}var p=this.manifest.getLicense();if(p){var h={label:"license",value:e&&e.licenseFormatter?e.licenseFormatter.format(p):p},s=new S.LabelValuePair(l);s.parse(h),s.isRootLevel=!0,c.addItem(s)}if(this.manifest.getLogo()){var h={label:"logo",value:'<img alt="logo" src="'+this.manifest.getLogo()+'"/>'},s=new S.LabelValuePair(l);s.parse(h),s.isRootLevel=!0,c.addItem(s)}return r.push(c),e?this._parseMetadataOptions(e,r):r},o.prototype.getAllRequiredStatements=function(){var e=[],r=this.getCurrentRange();if(r){var n=r.getRequiredStatement?r.getRequiredStatement():null;n&&e.push(w(w({},this.parseStatement(n)),{source:"Range"}))}var c=this.getCurrentCanvas();if(c){var l=c.getRequiredStatement?c.getRequiredStatement():null;l&&e.push(w(w({},this.parseStatement(l)),{source:"Canvas"}))}if(this.manifest){var s=this.manifest.getRequiredStatement();s&&s&&e.push(w(w({},this.parseStatement(s)),{source:"Manifest"}))}return e},o.prototype.getMostSpecificRequiredStatement=function(){var e=this.getAllRequiredStatements(),r=e.find(function(l){return l.source==="Range"});if(r)return r;var n=e.find(function(l){return l.source==="Canvas"});if(n)return n;var c=e.find(function(l){return l.source==="Manifest"});return c||null},o.prototype.getRequiredStatement=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.manifest.getRequiredStatement();return e?this.parseStatement(e):null},o.prototype.parseStatement=function(e){return{label:e.label?e.getLabel():"",value:e.value&&e.value.length?e.getValue():""}},o.prototype._parseMetadataOptions=function(e,r){var n=this.getCurrentSequence(),c=n.getMetadata();if(c&&c.length){var l=new V(n);l.addMetadata(c),r.push(l)}if(e.range){var s=this._getRangeMetadata([],e.range);s=s.reverse(),r=r.concat(s)}if(e.canvases&&e.canvases.length)for(var p=0;p<e.canvases.length;p++){var h=e.canvases[p],i=h.getMetadata();if(i&&i.length){var t=new V(h);t.addMetadata(h.getMetadata()),r.push(t)}for(var a=h.getImages(),u=0;u<a.length;u++){var f=a[u],g=f.getMetadata();if(g&&g.length){var _=new V(f);_.addMetadata(g),r.push(_)}}}return r},o.prototype._getRangeMetadata=function(e,r){var n=r.getMetadata();if(n&&n.length){var c=new V(r);c.addMetadata(n),e.push(c)}else if(r.parentRange)return this._getRangeMetadata(e,r.parentRange);return e},o.prototype.getMultiSelectState=function(){return this._multiSelectState||(this._multiSelectState=new z,this._multiSelectState.ranges=this.getRanges().slice(0),this._multiSelectState.canvases=this.getCurrentSequence().getCanvases().slice(0)),this._multiSelectState},o.prototype.getCurrentRange=function(){return this.rangeId?this.getRangeById(this.rangeId):null},o.prototype.getPosterCanvas=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getPosterCanvas()},o.prototype.getAccompanyingCanvas=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getAccompanyingCanvas()},o.prototype.getPosterImage=function(){var e=this.getPosterCanvas();if(e){var r=e.getContent();if(r&&r.length){var n=r[0],c=n.getBody();return c[0].id}}return null},o.prototype.getAccompanyingCanvasImage=function(){var e=this.getAccompanyingCanvas();if(e){var r=e.getContent();if(r&&r.length){var n=r[0],c=n.getBody();return c[0].id}}return null},o.prototype.getPreviousRange=function(e){var r=null;if(e?r=e:r=this.getCurrentRange(),r){var n=this.getFlattenedTree();if(n)for(var c=0;c<n.length;c++){var l=n[c];if(l&&l.data.id===r.id){for(;c>0;){c--;var s=n[c];return s.data}break}}}return null},o.prototype.getNextRange=function(e){var r=null;if(e?r=e:r=this.getCurrentRange(),r){var n=this.getFlattenedTree();if(n)for(var c=0;c<n.length;c++){var l=n[c];if(l&&l.data.id===r.id){for(;c<n.length-1;){c++;var s=n[c];if(s.data.canvases&&s.data.canvases.length)return s.data}break}}}return null},o.prototype.getFlattenedTree=function(e){var r=null;return e?r=e:r=this.getTree(),r?this._flattenTree(r,"nodes"):null},o.prototype._flattenTree=function(e,r){var n=this,c=[e];return e[r]&&e[r].length>0?c.concat(e[r].map(function(l){return n._flattenTree(l,r)}).reduce(function(l,s){return l.concat(s)},[])):c},o.prototype.getRanges=function(){return this.manifest.getAllRanges()},o.prototype.getRangeByPath=function(e){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getRangeByPath(e)},o.prototype.getRangeById=function(e){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getRangeById(e)},o.prototype.getRangeCanvases=function(e){var r=e.getCanvasIds();return this.getCanvasesById(r)},o.prototype.getRelated=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getRelated()},o.prototype.getSearchService=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.manifest.getService(N.ServiceProfile.SEARCH_0);return e||(e=this.manifest.getService(N.ServiceProfile.SEARCH_1)),e},o.prototype.getSeeAlso=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getSeeAlso()},o.prototype.getSequenceByIndex=function(e){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getSequenceByIndex(e)},o.prototype.getShareServiceUrl=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=null,r=this.manifest.getService(N.ServiceProfile.SHARE_EXTENSIONS);return r&&(r.length&&(r=r[0]),e=r.__jsonld.shareUrl),e},o.prototype._getSortedTreeNodesByDate=function(e,r){var n=this.getFlattenedTree(r);if(n){var c=n.filter(function(l){return l.data.type===S.TreeNodeType.MANIFEST});this.createDecadeNodes(e,n),this.sortDecadeNodes(e),this.createYearNodes(e,n),this.sortYearNodes(e),this.createMonthNodes(e,c),this.sortMonthNodes(e),this.createDateNodes(e,c),this.pruneDecadeNodes(e)}},o.prototype.getStartCanvasIndex=function(){return this.getCurrentSequence().getStartCanvasIndex()},o.prototype.getThumbs=function(e,r){return this.getCurrentSequence().getThumbs(e,r)},o.prototype.getTopRanges=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getTopRanges()},o.prototype.getTotalCanvases=function(){return this.getCurrentSequence().getTotalCanvases()},o.prototype.getTrackingLabel=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.getTrackingLabel()},o.prototype._getTopRanges=function(){return this.iiifResource.getTopRanges()},o.prototype.getTree=function(e,r){if(e===void 0&&(e=0),r===void 0&&(r=j.NONE),!this.iiifResource)return null;var n;if(this.iiifResource.isCollection())n=this.iiifResource.getDefaultTree();else{var c=this._getTopRanges(),l=new S.TreeNode;if(l.label="root",l.data=this.iiifResource,c.length){var s=c[e];n=s.getTree(l)}else return l}var p=new S.TreeNode;switch(r.toString()){case j.DATE.toString():if(this.treeHasNavDates(n))return this._getSortedTreeNodesByDate(p,n),p;break}return n},o.prototype.treeHasNavDates=function(e){var r=this.getFlattenedTree(e);return r?r.some(function(n){return!isNaN(n.navDate)}):!1},o.prototype.getViewingDirection=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.getCurrentSequence().getViewingDirection();return e||(e=this.manifest.getViewingDirection()),e},o.prototype.getViewingHint=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.getCurrentSequence().getViewingHint();return e||(e=this.manifest.getViewingHint()),e},o.prototype.hasParentCollection=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return!!this.manifest.parentCollection},o.prototype.hasRelatedPage=function(){var e=this.getRelated();return e?(e.length&&(e=e[0]),e.format==="text/html"):!1},o.prototype.hasResources=function(){var e=this.getCurrentCanvas();return e.getResources().length>0},o.prototype.isBottomToTop=function(){var e=this.getViewingDirection();return e?e===N.ViewingDirection.BOTTOM_TO_TOP:!1},o.prototype.isCanvasIndexOutOfRange=function(e){return this.getCurrentSequence().isCanvasIndexOutOfRange(e)},o.prototype.isContinuous=function(){var e=this.getViewingHint();return e?e===N.ViewingHint.CONTINUOUS:!1},o.prototype.isFirstCanvas=function(e){return typeof e!="undefined"?this.getCurrentSequence().isFirstCanvas(e):this.getCurrentSequence().isFirstCanvas(this.canvasIndex)},o.prototype.isHorizontallyAligned=function(){return this.isLeftToRight()||this.isRightToLeft()},o.prototype.isLastCanvas=function(e){return typeof e!="undefined"?this.getCurrentSequence().isLastCanvas(e):this.getCurrentSequence().isLastCanvas(this.canvasIndex)},o.prototype.isLeftToRight=function(){var e=this.getViewingDirection();return e?e===N.ViewingDirection.LEFT_TO_RIGHT:!1},o.prototype.isMultiCanvas=function(){return this.getCurrentSequence().isMultiCanvas()},o.prototype.isMultiSequence=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.isMultiSequence()},o.prototype.isPaged=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);var e=this.getViewingHint();return e?e===N.ViewingHint.PAGED:this.manifest.isPagingEnabled()},o.prototype.isPagingAvailable=function(){return this.isPagingEnabled()&&this.getTotalCanvases()>2},o.prototype.isPagingEnabled=function(){if(!this.manifest)throw new Error(L.manifestNotLoaded);return this.manifest.isPagingEnabled()||this.getCurrentSequence().isPagingEnabled()},o.prototype.isRightToLeft=function(){var e=this.getViewingDirection();return e?e===N.ViewingDirection.RIGHT_TO_LEFT:!1},o.prototype.isTopToBottom=function(){var e=this.getViewingDirection();return e?e===N.ViewingDirection.TOP_TO_BOTTOM:!1},o.prototype.isTotalCanvasesEven=function(){return this.getCurrentSequence().isTotalCanvasesEven()},o.prototype.isUIEnabled=function(e){if(!this.manifest)throw new Error(L.manifestNotLoaded);var r=this.manifest.getService(N.ServiceProfile.UI_EXTENSIONS);if(r){var n=r.getProperty("disableUI");if(n&&(n.indexOf(e)!==-1||n.indexOf(e.toLowerCase())!==-1))return!1}return!0},o.prototype.isVerticallyAligned=function(){return this.isTopToBottom()||this.isBottomToTop()},o.prototype.createDateNodes=function(e,r){for(var n=0;n<r.length;n++){var c=r[n],l=this.getNodeYear(c),s=this.getNodeMonth(c),p=new S.TreeNode;p.id=c.id,p.label=this.getNodeDisplayDate(c),p.data=c.data,p.data.type=S.TreeNodeType.MANIFEST,p.data.year=l,p.data.month=s;var h=this.getDecadeNode(e,l);if(h){var i=this.getYearNode(h,l);if(i){var t=this.getMonthNode(i,s);t&&t.addNode(p)}}}},o.prototype.createDecadeNodes=function(e,r){for(var n=0;n<r.length;n++){var c=r[n];if(!!c.navDate){var l=this.getNodeYear(c),s=Number(l.toString().substr(0,3)+"9");if(!this.getDecadeNode(e,l)){var p=new S.TreeNode;p.label=l+" - "+s,p.navDate=c.navDate,p.data.startYear=l,p.data.endYear=s,e.addNode(p)}}}},o.prototype.createMonthNodes=function(e,r){for(var n=0;n<r.length;n++){var c=r[n];if(!!c.navDate){var l=this.getNodeYear(c),s=this.getNodeMonth(c),p=this.getDecadeNode(e,l),h=null;if(p&&(h=this.getYearNode(p,l)),p&&h&&!this.getMonthNode(h,s)){var i=new S.TreeNode;i.label=this.getNodeDisplayMonth(c),i.navDate=c.navDate,i.data.year=l,i.data.month=s,h.addNode(i)}}}},o.prototype.createYearNodes=function(e,r){for(var n=0;n<r.length;n++){var c=r[n];if(!!c.navDate){var l=this.getNodeYear(c),s=this.getDecadeNode(e,l);if(s&&!this.getYearNode(s,l)){var p=new S.TreeNode;p.label=l.toString(),p.navDate=c.navDate,p.data.year=l,s.addNode(p)}}}},o.prototype.getDecadeNode=function(e,r){for(var n=0;n<e.nodes.length;n++){var c=e.nodes[n];if(r>=c.data.startYear&&r<=c.data.endYear)return c}return null},o.prototype.getMonthNode=function(e,r){for(var n=0;n<e.nodes.length;n++){var c=e.nodes[n];if(r===this.getNodeMonth(c))return c}return null},o.prototype.getNodeDisplayDate=function(e){return e.navDate.toDateString()},o.prototype.getNodeDisplayMonth=function(e){var r=["January","February","March","April","May","June","July","August","September","October","November","December"];return r[e.navDate.getMonth()]},o.prototype.getNodeMonth=function(e){return e.navDate.getMonth()},o.prototype.getNodeYear=function(e){return e.navDate.getFullYear()},o.prototype.getYearNode=function(e,r){for(var n=0;n<e.nodes.length;n++){var c=e.nodes[n];if(r===this.getNodeYear(c))return c}return null},o.prototype.pruneDecadeNodes=function(e){for(var r=[],n=0;n<e.nodes.length;n++){var c=e.nodes[n];c.nodes.length||r.push(c)}for(var l=0;l<r.length;l++){var s=r[l],p=e.nodes.indexOf(s);p>-1&&e.nodes.splice(p,1)}},o.prototype.sortDecadeNodes=function(e){e.nodes=e.nodes.sort(function(r,n){return r.data.startYear-n.data.startYear})},o.prototype.sortMonthNodes=function(e){for(var r=this,n=0;n<e.nodes.length;n++)for(var c=e.nodes[n],l=0;l<c.nodes.length;l++){var s=c.nodes[l];s.nodes=s.nodes.sort(function(p,h){return r.getNodeMonth(p)-r.getNodeMonth(h)})}},o.prototype.sortYearNodes=function(e){for(var r=this,n=0;n<e.nodes.length;n++){var c=e.nodes[n];c.nodes=c.nodes.sort(function(l,s){return r.getNodeYear(l)-r.getNodeYear(s)})}},o}();var J=b(H()),K=b(G()),Z=function(){function o(e){this._options=e,this._options.locale=this._options.locale||"en-GB"}return o.prototype.bootstrap=function(e,r){var n=this;return new Promise(function(c,l){e&&r&&(c=e,l=r),K.Utils.loadManifest(n._options.manifestUri).then(function(s){n._loaded(n,s,c,l)}).catch(function(s){l(s)})})},o.prototype._loaded=function(e,r,n,c){var l=K.Utils.parseManifest(r,{locale:e._options.locale});if(l){e._options.iiifResource||(e._options.iiifResource=l);var s=e._options.collectionIndex,p=e._options.manifestIndex;if(l.getIIIFResourceType()===J.IIIFResourceType.COLLECTION){var h=l.getManifests(),i=l.getCollections();!h.length&&s===void 0&&(s=0),s!==void 0&&i&&i.length?l.getCollectionByIndex(s).then(function(a){a||c("Collection index not found"),a.getTotalManifests()===0&&p===0&&a.getTotalCollections()>0?(e._options.collectionIndex=0,e._options.manifestUri=a.id,e.bootstrap(n,c)):p!==void 0&&a.getManifestByIndex(p).then(function(u){e._options.manifest=u;var f=new F(e._options);n(f)})}):l.getManifestByIndex(e._options.manifestIndex).then(function(a){e._options.manifest=a;var u=new F(e._options);n(u)})}else{e._options.manifest=l;var t=new F(e._options);n(t)}}else console.error("Unable to load IIIF resource")},o}();var O=b(H()),D=b($()),P=b(G()),Rt=function(){function o(e,r){this.authHoldingPage=null,this.clickThroughService=null,this.externalService=null,this.isProbed=!1,this.isResponseHandled=!1,this.kioskService=null,this.loginService=null,this.logoutService=null,this.probeService=null,this.restrictedService=null,this.tokenService=null,e.externalResource=this,this.dataUri=this._getDataUri(e),this.index=e.index,this.authAPIVersion=r.authApiVersion,this._parseAuthServices(e),this._parseCanvasDimensions(e)}return o.prototype._getImageServiceDescriptor=function(e){for(var r=null,n=0;n<e.length;n++){var c=e[n],l=c.id;l.endsWith("/")||(l+="/"),c.getProfile()&&(P.Utils.isImageProfile(c.getProfile())||P.Utils.isImageServiceType(c.getIIIFResourceType()))&&(r=l+"info.json")}return r},o.prototype._getDataUri=function(e){var r=e.getContent(),n=e.getImages(),c=null;if(r&&r.length){var l=r[0],s=l.getBody();if(s.length){var p=s[0],h=p.getServices();return h.length&&(c=this._getImageServiceDescriptor(h),c)?c:s[0].id}return null}else if(n&&n.length){var i=n[0],t=i.getResource(),h=t.getServices();return h.length&&(c=this._getImageServiceDescriptor(h),c)?c:t.id}else{var a=e.getService(O.ServiceProfile.IXIF);return a?a.getInfoUri():e.id}},o.prototype._parseAuthServices=function(e){if(this.authAPIVersion===.9)this.clickThroughService=P.Utils.getService(e,O.ServiceProfile.AUTH_0_CLICK_THROUGH),this.loginService=P.Utils.getService(e,O.ServiceProfile.AUTH_0_LOGIN),this.restrictedService=P.Utils.getService(e,O.ServiceProfile.AUTH_0_RESTRICTED),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(O.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.clickThroughService.getService(O.ServiceProfile.AUTH_0_TOKEN)):this.loginService?(this.logoutService=this.loginService.getService(O.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.loginService.getService(O.ServiceProfile.AUTH_0_TOKEN)):this.restrictedService&&(this.logoutService=this.restrictedService.getService(O.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.restrictedService.getService(O.ServiceProfile.AUTH_0_TOKEN));else{if(e.isCanvas!==void 0&&e.isCanvas()){var r=e.getContent();if(r&&r.length){var n=r[0].getBody();if(n&&n.length){var c=n[0];e=c}}}this.clickThroughService=P.Utils.getService(e,O.ServiceProfile.AUTH_1_CLICK_THROUGH),this.loginService=P.Utils.getService(e,O.ServiceProfile.AUTH_1_LOGIN),this.externalService=P.Utils.getService(e,O.ServiceProfile.AUTH_1_EXTERNAL),this.kioskService=P.Utils.getService(e,O.ServiceProfile.AUTH_1_KIOSK),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(O.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.clickThroughService.getService(O.ServiceProfile.AUTH_1_TOKEN),this.probeService=this.clickThroughService.getService(O.ServiceProfile.AUTH_1_PROBE)):this.loginService?(this.logoutService=this.loginService.getService(O.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.loginService.getService(O.ServiceProfile.AUTH_1_TOKEN),this.probeService=P.Utils.getService(e,O.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.loginService.getService(O.ServiceProfile.AUTH_1_PROBE))):this.externalService?(this.logoutService=this.externalService.getService(O.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.externalService.getService(O.ServiceProfile.AUTH_1_TOKEN),this.probeService=P.Utils.getService(e,O.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.externalService.getService(O.ServiceProfile.AUTH_1_PROBE))):this.kioskService&&(this.logoutService=this.kioskService.getService(O.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.kioskService.getService(O.ServiceProfile.AUTH_1_TOKEN),this.probeService=P.Utils.getService(e,O.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.kioskService.getService(O.ServiceProfile.AUTH_1_PROBE)))}},o.prototype._parseCanvasDimensions=function(e){var r=e.getImages();if(r&&r.length){var n=r[0],c=n.getResource();this.width=c.getWidth(),this.height=c.getHeight()}else if(r=e.getContent(),r.length){var l=r[0],s=l.getBody();s.length&&(this.width=s[0].getWidth(),this.height=s[0].getHeight())}},o.prototype._parseDescriptorDimensions=function(e){e.width!==void 0&&(this.width=e.width),e.height!==void 0&&(this.height=e.height)},o.prototype.isAccessControlled=function(){return!!(this.clickThroughService||this.loginService||this.externalService||this.kioskService||this.probeService)},o.prototype.hasServiceDescriptor=function(){return this.dataUri?this.dataUri.endsWith("info.json"):!1},o.prototype.getData=function(e){var r=this;return r.data={},new Promise(function(n,c){if(!r.dataUri){c("There is no dataUri to fetch");return}if(r.probeService){r.isProbed=!0;var l=new XMLHttpRequest;l.open("GET",r.probeService.id,!0),l.withCredentials=!1,e&&l.setRequestHeader("Authorization","Bearer "+e.accessToken),l.onload=function(){var h=JSON.parse(l.responseText),i=unescape(h.contentLocation);r.status=l.status,i!==r.dataUri&&(r.status=D.MOVED_TEMPORARILY),r.data=h,n(r)},l.onerror=function(){r.status=l.status,n(r)},l.send()}else{var s="GET";if(!r.hasServiceDescriptor()){if(!r.isAccessControlled()){r.status=D.OK,n(r);return}s="HEAD"}var p=new XMLHttpRequest;p.open(s,r.dataUri,!0),p.withCredentials=!1,e&&p.setRequestHeader("Authorization","Bearer "+e.accessToken),p.onload=function(){if(!p.responseText)r.status=p.status||D.OK,n(r);else{var h=JSON.parse(p.responseText),i=p.status,t=unescape(h["@id"]||h.id);r.data=h,r._parseAuthServices(r.data),r._parseDescriptorDimensions(r.data),t.endsWith("/info.json")&&(t=t.substr(0,t.lastIndexOf("/")));var a=r.dataUri;a&&a.endsWith("/info.json")&&(a=a.substr(0,a.lastIndexOf("/"))),i===D.OK&&t!==a&&r.loginService?r.status=D.MOVED_TEMPORARILY:r.status=i,n(r)}},p.onerror=function(){r.status=p.status,p.responseText&&r._parseAuthServices(JSON.parse(p.responseText)),n(r)},p.send()}})},o}();var Mt=function(){function o(){}return o}();var bt=function(){function o(){}return o}();var Dt=function(){function o(e,r){this.value=e,this.locale=r}return o}();var Vt=function(){function o(e){this.labels=e}return o.prototype.format=function(e){if(e.indexOf("<a")!=-1)return e;var r=this.labels[e]?this.labels[e]:e;return'<a href="'+e+'">'+r+"</a>"},o}();var jt=function(o){return new Z(o).bootstrap()};export{H as a,_t as b,G as c,j as d,$ as e,Vt as f,jt as g};
